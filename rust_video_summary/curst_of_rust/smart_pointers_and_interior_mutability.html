<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js navy">
<head>
    <!-- Book generated using mdBook -->
    <meta charset="UTF-8">
    <title>Smart Pointers And Interior Mutability - The Rust Programming Language</title>


    <!-- Custom HTML head -->
    
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#ffffff"/>

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../md-favicon.png">
    <link rel="stylesheet" href="../../css/variables.css">
    <link rel="stylesheet" href="../../css/general.css">
    <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

    <!-- Fonts -->
    <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

    <!-- Highlight.js Stylesheets -->
    <link rel="stylesheet" href="../../highlight.css">
    <link rel="stylesheet" href="../../tomorrow-night.css">
    <link rel="stylesheet" href="../../ayu-highlight.css">

    <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../../assets/ferris/ferris.css">
        <link rel="stylesheet" href="../../theme/2018-edition.css">
        <link rel="stylesheet" href="../../assets/pagetoc/pagetoc_style.css">
        <link rel="stylesheet" href="../../assets/css/mdbook-admonish.css">

</head>
<body>
<!-- Provide site root to javascript -->
<script type="text/javascript">
    var path_to_root = "../../";
    var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "navy";
</script>

<!-- Work around some values being stored in localStorage wrapped in quotes -->
<script type="text/javascript">
    try {
        var theme = localStorage.getItem('mdbook-theme');
        var sidebar = localStorage.getItem('mdbook-sidebar');

        if (theme.startsWith('"') && theme.endsWith('"')) {
            localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
        }

        if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
            localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
        }
    } catch (e) {
    }
</script>

<!-- Set the theme before any content is loaded, prevents flash -->
<script type="text/javascript">
    var theme;
    try {
        theme = localStorage.getItem('mdbook-theme');
    } catch (e) {
    }
    if (theme === null || theme === undefined) {
        theme = default_theme;
    }
    var html = document.querySelector('html');
    html.classList.remove('no-js')
    html.classList.remove('navy')
    html.classList.add(theme);
    html.classList.add('js');
</script>

<!-- Hide / unhide sidebar before it is displayed -->
<script type="text/javascript">
    var html = document.querySelector('html');
    var sidebar = 'hidden';
    if (document.body.clientWidth >= 1080) {
        try {
            sidebar = localStorage.getItem('mdbook-sidebar');
        } catch (e) {
        }
        sidebar = sidebar || 'visible';
    }
    html.classList.remove('sidebar-visible');
    html.classList.add("sidebar-" + sidebar);
</script>

<nav id="sidebar" class="sidebar" aria-label="Table of contents">
    <div class="sidebar-scrollbox">
        <ol class="chapter"><li class="chapter-item expanded "><a href="../../not_involved_resources.html"><strong aria-hidden="true">1.</strong> Not Involved Resources</a></li><li class="chapter-item expanded "><a href="../../overviews.html"><strong aria-hidden="true">2.</strong> Overviews</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../overviews/rbe_radial_tree_embed.html"><strong aria-hidden="true">2.1.</strong> Rust By Examples</a></li></ol></li><li class="chapter-item expanded "><a href="../../title-page.html"><strong aria-hidden="true">3.</strong> Rust Topics</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../chatgpt_rust/chatgpt_rust_prompts.html"><strong aria-hidden="true">3.1.</strong> chatGPT Rust Q&A</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../chatgpt_rust/rust_grammar_experience_pitfalls.html"><strong aria-hidden="true">3.1.1.</strong> Experience & Pitfall</a></li></ol></li><li class="chapter-item expanded "><a href="../../rust_video_summary/rust_video_summary.html"><strong aria-hidden="true">3.2.</strong> Rust Video Summary</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../rust_video_summary/code_to_the_moon/code_to_the_moon.html"><strong aria-hidden="true">3.2.1.</strong> Code to the Moon</a></li><li class="chapter-item expanded "><a href="../../rust_video_summary/curst_of_rust/crust_of_rust.html"><strong aria-hidden="true">3.2.2.</strong> Crust Of Rust Series</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../rust_video_summary/curst_of_rust/async_await.html"><strong aria-hidden="true">3.2.2.1.</strong> Async/Await</a></li><li class="chapter-item "><a href="../../rust_video_summary/curst_of_rust/atomics_and_memory_ordering.html"><strong aria-hidden="true">3.2.2.2.</strong> Atomics and Memory Ordering</a></li><li class="chapter-item "><a href="../../rust_video_summary/curst_of_rust/channels.html"><strong aria-hidden="true">3.2.2.3.</strong> Channels</a></li><li class="chapter-item "><a href="../../rust_video_summary/curst_of_rust/declarative_macros.html"><strong aria-hidden="true">3.2.2.4.</strong> Declarative Macros</a></li><li class="chapter-item "><a href="../../rust_video_summary/curst_of_rust/dispatch_and_fat_pointers.html"><strong aria-hidden="true">3.2.2.5.</strong> Dispatch and Fat Pointers</a></li><li class="chapter-item "><a href="../../rust_video_summary/curst_of_rust/functions_closures_and_their_traits.html"><strong aria-hidden="true">3.2.2.6.</strong> Functions, Closures and their traits</a></li><li class="chapter-item "><a href="../../rust_video_summary/curst_of_rust/iterators.html"><strong aria-hidden="true">3.2.2.7.</strong> Iterators</a></li><li class="chapter-item "><a href="../../rust_video_summary/curst_of_rust/lifetime_annotations.html"><strong aria-hidden="true">3.2.2.8.</strong> Lifetime Annotations</a></li><li class="chapter-item expanded "><a href="../../rust_video_summary/curst_of_rust/smart_pointers_and_interior_mutability.html" class="active"><strong aria-hidden="true">3.2.2.9.</strong> Smart Pointers And Interior Mutability</a></li><li class="chapter-item "><a href="../../rust_video_summary/curst_of_rust/sorting_algorithms.html"><strong aria-hidden="true">3.2.2.10.</strong> Sorting Algorithms</a></li><li class="chapter-item "><a href="../../rust_video_summary/curst_of_rust/subtyping_and_variance.html"><strong aria-hidden="true">3.2.2.11.</strong> Subtyping and Variance</a></li><li class="chapter-item "><a href="../../rust_video_summary/curst_of_rust/the_drop_check.html"><strong aria-hidden="true">3.2.2.12.</strong> The Drop Check</a></li></ol></li><li class="chapter-item "><a href="../../rust_video_summary/implementing_hazard_pointers_in_rust/implementing_hazard_pointers.html"><strong aria-hidden="true">3.2.3.</strong> Implementing Hazard Pointers</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../rust_video_summary/implementing_hazard_pointers_in_rust/part1.html"><strong aria-hidden="true">3.2.3.1.</strong> Part 1</a></li><li class="chapter-item "><a href="../../rust_video_summary/implementing_hazard_pointers_in_rust/part2.html"><strong aria-hidden="true">3.2.3.2.</strong> Part 2</a></li><li class="chapter-item "><a href="../../rust_video_summary/implementing_hazard_pointers_in_rust/part3.html"><strong aria-hidden="true">3.2.3.3.</strong> Part 3</a></li><li class="chapter-item "><a href="../../rust_video_summary/implementing_hazard_pointers_in_rust/part4.html"><strong aria-hidden="true">3.2.3.4.</strong> Part 4</a></li></ol></li><li class="chapter-item "><a href="../../rust_video_summary/impl_rust/impl_rust.html"><strong aria-hidden="true">3.2.4.</strong> Impl Rust</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../rust_video_summary/impl_rust/solving_distributed_system_challenges_in_rust.html"><strong aria-hidden="true">3.2.4.1.</strong> Solving Distributed System Challenges</a></li></ol></li><li class="chapter-item "><a href="../../rust_video_summary/open_source_streams/open_source_streams.html"><strong aria-hidden="true">3.2.5.</strong> Open-Source streams</a></li><li class="chapter-item "><a href="../../rust_video_summary/stop_duplicating_your_code.html"><strong aria-hidden="true">3.2.6.</strong> Stop Duplicating Your Code</a></li><li class="chapter-item "><a href="../../rust_video_summary/rust_crash_course_rustlang.html"><strong aria-hidden="true">3.2.7.</strong> Rust Crash Course</a></li></ol></li><li class="chapter-item "><div><strong aria-hidden="true">3.3.</strong> Associated Items</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../topics/at_gat.html"><strong aria-hidden="true">3.3.1.</strong> Associated type, Generic associate types</a></li><li class="chapter-item "><div><strong aria-hidden="true">3.3.2.</strong> Associated Types</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../rust_by_example_src/generics/assoc_items/types.html"><strong aria-hidden="true">3.3.2.1.</strong> Associated types examples</a></li></ol></li><li class="chapter-item "><div><strong aria-hidden="true">3.3.3.</strong> Generic Associated Types</div></li><li class="chapter-item "><div><strong aria-hidden="true">3.3.4.</strong> Associated Functions & Methods</div></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../../title-page.html"><strong aria-hidden="true">4.</strong> The Rust Programming Language</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../foreword.html"><strong aria-hidden="true">4.1.</strong> Foreword</a></li><li class="chapter-item "><a href="../../ch00-00-introduction.html"><strong aria-hidden="true">4.2.</strong> Introduction</a></li><li class="chapter-item "><a href="../../ch01-00-getting-started.html"><strong aria-hidden="true">4.3.</strong> Getting Started</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../ch01-01-installation.html"><strong aria-hidden="true">4.3.1.</strong> Installation</a></li><li class="chapter-item "><a href="../../ch01-02-hello-world.html"><strong aria-hidden="true">4.3.2.</strong> Hello, World!</a></li><li class="chapter-item "><a href="../../ch01-03-hello-cargo.html"><strong aria-hidden="true">4.3.3.</strong> Hello, Cargo!</a></li><li class="chapter-item "><a href="../../ch02-00-guessing-game-tutorial.html"><strong aria-hidden="true">4.3.4.</strong> Programming a Guessing Game</a></li><li class="chapter-item "><a href="../../ch03-00-common-programming-concepts.html"><strong aria-hidden="true">4.3.5.</strong> Common Programming Concepts</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../ch03-01-variables-and-mutability.html"><strong aria-hidden="true">4.3.5.1.</strong> ⚠️Variables and Mutability</a></li><li class="chapter-item "><a href="../../ch03-02-data-types.html"><strong aria-hidden="true">4.3.5.2.</strong> Data Types</a></li><li class="chapter-item "><a href="../../rust_by_example_src/expression.html"><strong aria-hidden="true">4.3.5.3.</strong> RBE(Rust by Examples): Expressions and Statements</a></li><li class="chapter-item "><a href="../../ch03-03-how-functions-work.html"><strong aria-hidden="true">4.3.5.4.</strong> ✨Functions Basic: Statements, Expressions, Last Return, Early Return</a></li><li class="chapter-item "><a href="../../ch03-04-comments.html"><strong aria-hidden="true">4.3.5.5.</strong> Comments</a></li><li class="chapter-item "><a href="../../ch03-05-control-flow.html"><strong aria-hidden="true">4.3.5.6.</strong> Control Flow</a></li></ol></li><li class="chapter-item "><a href="../../ch04-00-understanding-ownership.html"><strong aria-hidden="true">4.3.6.</strong> Understanding Ownership</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../ch04-01-what-is-ownership.html"><strong aria-hidden="true">4.3.6.1.</strong> What is Ownership?</a></li><li class="chapter-item "><a href="../../ch04-02-references-and-borrowing.html"><strong aria-hidden="true">4.3.6.2.</strong> References and Borrowing</a></li><li class="chapter-item "><a href="../../ch04-03-slices.html"><strong aria-hidden="true">4.3.6.3.</strong> The Slice Type</a></li></ol></li><li class="chapter-item "><a href="../../ch05-00-structs.html"><strong aria-hidden="true">4.3.7.</strong> Using Structs to Structure Related Data</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../ch05-01-defining-structs.html"><strong aria-hidden="true">4.3.7.1.</strong> Defining and Instantiating Structs</a></li><li class="chapter-item "><a href="../../ch05-02-example-structs.html"><strong aria-hidden="true">4.3.7.2.</strong> An Example Program Using Structs</a></li><li class="chapter-item "><a href="../../ch05-03-method-syntax.html"><strong aria-hidden="true">4.3.7.3.</strong> ✨Method Syntax</a></li></ol></li><li class="chapter-item "><a href="../../ch06-00-enums.html"><strong aria-hidden="true">4.3.8.</strong> Enums and Pattern Matching</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../ch06-01-defining-an-enum.html"><strong aria-hidden="true">4.3.8.1.</strong> Defining an Enum</a></li><li class="chapter-item "><a href="../../ch06-02-match.html"><strong aria-hidden="true">4.3.8.2.</strong> The match Control Flow Construct</a></li><li class="chapter-item "><a href="../../ch06-03-if-let.html"><strong aria-hidden="true">4.3.8.3.</strong> Concise Control Flow with if let</a></li></ol></li></ol></li><li class="chapter-item "><div><strong aria-hidden="true">4.4.</strong> Basic Rust Literacy</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../ch07-00-managing-growing-projects-with-packages-crates-and-modules.html"><strong aria-hidden="true">4.4.1.</strong> Managing Growing Projects with Packages, Crates, and Modules</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../ch07-01-packages-and-crates.html"><strong aria-hidden="true">4.4.1.1.</strong> Packages and Crates</a></li><li class="chapter-item "><a href="../../ch07-02-defining-modules-to-control-scope-and-privacy.html"><strong aria-hidden="true">4.4.1.2.</strong> Defining Modules to Control Scope and Privacy</a></li><li class="chapter-item "><a href="../../ch07-03-paths-for-referring-to-an-item-in-the-module-tree.html"><strong aria-hidden="true">4.4.1.3.</strong> Paths for Referring to an Item in the Module Tree</a></li><li class="chapter-item "><a href="../../ch07-04-bringing-paths-into-scope-with-the-use-keyword.html"><strong aria-hidden="true">4.4.1.4.</strong> Bringing Paths Into Scope with the use Keyword</a></li><li class="chapter-item "><a href="../../ch07-05-separating-modules-into-different-files.html"><strong aria-hidden="true">4.4.1.5.</strong> Separating Modules into Different Files</a></li></ol></li><li class="chapter-item "><a href="../../ch08-00-common-collections.html"><strong aria-hidden="true">4.4.2.</strong> Common Collections</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../ch08-01-vectors.html"><strong aria-hidden="true">4.4.2.1.</strong> Vectors: Storing Lists of The Same Type of Values</a></li><li class="chapter-item "><a href="../../ch08-02-strings.html"><strong aria-hidden="true">4.4.2.2.</strong> Strings: Storing UTF-8 Encoded Text</a></li><li class="chapter-item "><a href="../../ch08-03-hash-maps.html"><strong aria-hidden="true">4.4.2.3.</strong> HasnMap&lt;K, V&gt;: Storing Keys with Associated Values</a></li></ol></li><li class="chapter-item "><a href="../../ch09-00-error-handling.html"><strong aria-hidden="true">4.4.3.</strong> Error Handling</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../ch09-01-unrecoverable-errors-with-panic.html"><strong aria-hidden="true">4.4.3.1.</strong> Unrecoverable Errors with panic!</a></li><li class="chapter-item "><a href="../../ch09-02-recoverable-errors-with-result.html"><strong aria-hidden="true">4.4.3.2.</strong> ⭐️Recoverable Errors with Result</a></li><li class="chapter-item "><a href="../../ch09-03-to-panic-or-not-to-panic.html"><strong aria-hidden="true">4.4.3.3.</strong> To panic! or Not to panic!</a></li></ol></li><li class="chapter-item "><a href="../../ch10-00-generics.html"><strong aria-hidden="true">4.4.4.</strong> Generic Types, Traits, and Lifetimes</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../ch10-01-syntax.html"><strong aria-hidden="true">4.4.4.1.</strong> ✨Generic Data Types</a></li><li class="chapter-item "><a href="../../ch10-02-traits.html"><strong aria-hidden="true">4.4.4.2.</strong> 🪐Traits: Defining Shared Behavior</a></li><li class="chapter-item "><a href="../../ch10-03-lifetime-syntax.html"><strong aria-hidden="true">4.4.4.3.</strong> ⭐️Validating References with Lifetimes</a></li></ol></li><li class="chapter-item "><a href="../../ch11-00-testing.html"><strong aria-hidden="true">4.4.5.</strong> Writing Automated Tests</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../ch11-01-writing-tests.html"><strong aria-hidden="true">4.4.5.1.</strong> How to Write Tests</a></li><li class="chapter-item "><a href="../../ch11-02-running-tests.html"><strong aria-hidden="true">4.4.5.2.</strong> Controlling How Tests Are Run</a></li><li class="chapter-item "><a href="../../ch11-03-test-organization.html"><strong aria-hidden="true">4.4.5.3.</strong> Test Organization</a></li></ol></li><li class="chapter-item "><a href="../../ch12-00-an-io-project.html"><strong aria-hidden="true">4.4.6.</strong> An I/O Project: Building a Command Line Program</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../ch12-01-accepting-command-line-arguments.html"><strong aria-hidden="true">4.4.6.1.</strong> Accepting Command Line Arguments</a></li><li class="chapter-item "><a href="../../ch12-02-reading-a-file.html"><strong aria-hidden="true">4.4.6.2.</strong> Reading a File</a></li><li class="chapter-item "><a href="../../ch12-03-improving-error-handling-and-modularity.html"><strong aria-hidden="true">4.4.6.3.</strong> Refactoring to Improve Modularity and Error Handling</a></li><li class="chapter-item "><a href="../../ch12-04-testing-the-librarys-functionality.html"><strong aria-hidden="true">4.4.6.4.</strong> Developing the Library’s Functionality with Test Driven Development</a></li><li class="chapter-item "><a href="../../ch12-05-working-with-environment-variables.html"><strong aria-hidden="true">4.4.6.5.</strong> Working with Environment Variables</a></li><li class="chapter-item "><a href="../../ch12-06-writing-to-stderr-instead-of-stdout.html"><strong aria-hidden="true">4.4.6.6.</strong> Writing Error Messages to Standard Error Instead of Standard Output</a></li></ol></li></ol></li><li class="chapter-item "><a href="../../thinking_in_rust.html"><strong aria-hidden="true">4.5.</strong> 🤔Thinking in Rust</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../ch13-00-functional-features.html"><strong aria-hidden="true">4.5.1.</strong> Functional Language Features: Iterators and Closures</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../ch13-01-closures.html"><strong aria-hidden="true">4.5.1.1.</strong> Closures: Anonymous Functions that Capture Their Environment</a></li><li class="chapter-item "><a href="../../ch13-02-iterators.html"><strong aria-hidden="true">4.5.1.2.</strong> Processing a Series of Items with Iterators</a></li><li class="chapter-item "><a href="../../ch13-03-improving-our-io-project.html"><strong aria-hidden="true">4.5.1.3.</strong> Improving Our I/O Project</a></li><li class="chapter-item "><a href="../../ch13-04-performance.html"><strong aria-hidden="true">4.5.1.4.</strong> Comparing Performance: Loops vs. Iterators</a></li></ol></li><li class="chapter-item "><a href="../../ch14-00-more-about-cargo.html"><strong aria-hidden="true">4.5.2.</strong> More about Cargo and Crates.io</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../ch14-01-release-profiles.html"><strong aria-hidden="true">4.5.2.1.</strong> Customizing Builds with Release Profiles</a></li><li class="chapter-item "><a href="../../ch14-02-publishing-to-crates-io.html"><strong aria-hidden="true">4.5.2.2.</strong> Publishing a Crate to Crates.io</a></li><li class="chapter-item "><a href="../../ch14-03-cargo-workspaces.html"><strong aria-hidden="true">4.5.2.3.</strong> Cargo Workspaces</a></li><li class="chapter-item "><a href="../../ch14-04-installing-binaries.html"><strong aria-hidden="true">4.5.2.4.</strong> Installing Binaries from Crates.io with cargo install</a></li><li class="chapter-item "><a href="../../ch14-05-extending-cargo.html"><strong aria-hidden="true">4.5.2.5.</strong> Extending Cargo with Custom Commands</a></li></ol></li><li class="chapter-item "><a href="../../ch15-00-smart-pointers.html"><strong aria-hidden="true">4.5.3.</strong> ✨Smart Pointers(2+3): (Deref、Drop) + (Box/heap、Rc、RefCell/Reference Cycle）</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../smart_pointers_deref_drop.html"><strong aria-hidden="true">4.5.3.1.</strong> Two Typical Traits: Deref & Drop</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../ch15-02-deref.html"><strong aria-hidden="true">4.5.3.1.1.</strong> Deref(* operator): Treating Smart Pointers Like Regular References with the Deref Trait</a></li><li class="chapter-item "><a href="../../ch15-03-drop.html"><strong aria-hidden="true">4.5.3.1.2.</strong> Drop: Running Code on Cleanup with the Drop Trait</a></li></ol></li><li class="chapter-item "><div><strong aria-hidden="true">4.5.3.2.</strong> Three main types</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../ch15-01-box.html"><strong aria-hidden="true">4.5.3.2.1.</strong> Heap: Using Box&lt;T&gt; to Point to Data on the Heap</a></li><li class="chapter-item "><a href="../../rc_refcell.html"><strong aria-hidden="true">4.5.3.2.2.</strong> References Tracking Pointer Types</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../ch15-04-rc.html"><strong aria-hidden="true">4.5.3.2.2.1.</strong> Rc&lt;T&gt;(Reference Counting): single-threaded scenarios, immutable references of multiple owners, the Reference Counted Smart Pointer</a></li><li class="chapter-item "><a href="../../ch15-05-interior-mutability.html"><strong aria-hidden="true">4.5.3.2.2.2.</strong> RefCell&lt;T&gt;(reference counting cell): single-threaded scenarios, runtime borrow checking, the Interior Mutability Pattern</a></li><li class="chapter-item "><a href="../../ch15-06-reference-cycles.html"><strong aria-hidden="true">4.5.3.2.2.3.</strong> 🌟Reference Cycles Can Leak Memory: Mainly from Incorrect Usage of Rc&lt;T&gt; and RefCell&lt;T&gt;</a></li></ol></li></ol></li></ol></li><li class="chapter-item "><a href="../../ch16-00-concurrency.html"><strong aria-hidden="true">4.5.4.</strong> Fearless Concurrency</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../ch16-01-threads.html"><strong aria-hidden="true">4.5.4.1.</strong> Using Threads to Run Code Simultaneously</a></li><li class="chapter-item "><a href="../../ch16-02-message-passing.html"><strong aria-hidden="true">4.5.4.2.</strong> Using Message Passing to Transfer Data Between Threads</a></li><li class="chapter-item "><a href="../../ch16-03-shared-state.html"><strong aria-hidden="true">4.5.4.3.</strong> Shared-State Concurrency</a></li><li class="chapter-item "><a href="../../ch16-04-extensible-concurrency-sync-and-send.html"><strong aria-hidden="true">4.5.4.4.</strong> Extensible Concurrency with the Sync and Send Traits</a></li></ol></li><li class="chapter-item "><a href="../../ch17-00-oop.html"><strong aria-hidden="true">4.5.5.</strong> Object Oriented Programming Features of Rust</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../ch17-01-what-is-oo.html"><strong aria-hidden="true">4.5.5.1.</strong> Characteristics of Object-Oriented Languages</a></li><li class="chapter-item "><a href="../../ch17-02-trait-objects.html"><strong aria-hidden="true">4.5.5.2.</strong> 🌛️Using Trait Objects That Allow for Values of Different Types</a></li><li class="chapter-item "><a href="../../ch17-03-oo-design-patterns.html"><strong aria-hidden="true">4.5.5.3.</strong> Implementing an Object-Oriented Design Pattern</a></li></ol></li></ol></li><li class="chapter-item "><div><strong aria-hidden="true">4.6.</strong> Advanced Topics</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../ch18-00-patterns.html"><strong aria-hidden="true">4.6.1.</strong> Patterns and Matching</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../ch18-01-all-the-places-for-patterns.html"><strong aria-hidden="true">4.6.1.1.</strong> All the Places Patterns Can Be Used</a></li><li class="chapter-item "><a href="../../ch18-02-refutability.html"><strong aria-hidden="true">4.6.1.2.</strong> Refutability: Whether a Pattern Might Fail to Match</a></li><li class="chapter-item "><a href="../../ch18-03-pattern-syntax.html"><strong aria-hidden="true">4.6.1.3.</strong> ⭐️Pattern Syntax</a></li></ol></li><li class="chapter-item "><a href="../../ch19-00-advanced-features.html"><strong aria-hidden="true">4.6.2.</strong> Advanced Features</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../ch19-01-unsafe-rust.html"><strong aria-hidden="true">4.6.2.1.</strong> Unsafe Rust</a></li><li class="chapter-item "><a href="../../ch19-03-advanced-traits.html"><strong aria-hidden="true">4.6.2.2.</strong> ⭐️Advanced Traits</a></li><li class="chapter-item "><a href="../../ch19-04-advanced-types.html"><strong aria-hidden="true">4.6.2.3.</strong> ✨Advanced Types</a></li><li class="chapter-item "><a href="../../ch19-05-advanced-functions-and-closures.html"><strong aria-hidden="true">4.6.2.4.</strong> 📦Advanced Functions and Closures</a></li><li class="chapter-item "><a href="../../ch19-06-macros.html"><strong aria-hidden="true">4.6.2.5.</strong> Macros</a></li></ol></li><li class="chapter-item "><a href="../../ch20-00-final-project-a-web-server.html"><strong aria-hidden="true">4.6.3.</strong> Final Project: Building a Multithreaded Web Server</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../ch20-01-single-threaded.html"><strong aria-hidden="true">4.6.3.1.</strong> Building a Single-Threaded Web Server</a></li><li class="chapter-item "><a href="../../ch20-02-multithreaded.html"><strong aria-hidden="true">4.6.3.2.</strong> Turning Our Single-Threaded Server into a Multithreaded Server</a></li><li class="chapter-item "><a href="../../ch20-03-graceful-shutdown-and-cleanup.html"><strong aria-hidden="true">4.6.3.3.</strong> Graceful Shutdown and Cleanup</a></li></ol></li><li class="chapter-item "><a href="../../appendix-00.html"><strong aria-hidden="true">4.6.4.</strong> Appendix</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../appendix-01-keywords.html"><strong aria-hidden="true">4.6.4.1.</strong> A - Keywords</a></li><li class="chapter-item "><a href="../../appendix-02-operators.html"><strong aria-hidden="true">4.6.4.2.</strong> B - Operators and Symbols</a></li><li class="chapter-item "><a href="../../appendix-03-derivable-traits.html"><strong aria-hidden="true">4.6.4.3.</strong> ✨️C - Derivable Traits</a></li><li class="chapter-item "><a href="../../appendix-04-useful-development-tools.html"><strong aria-hidden="true">4.6.4.4.</strong> D - Useful Development Tools</a></li><li class="chapter-item "><a href="../../appendix-05-editions.html"><strong aria-hidden="true">4.6.4.5.</strong> E - Editions</a></li><li class="chapter-item "><a href="../../appendix-06-translation.html"><strong aria-hidden="true">4.6.4.6.</strong> F - Translations of the Book</a></li><li class="chapter-item "><a href="../../appendix-07-nightly-rust.html"><strong aria-hidden="true">4.6.4.7.</strong> G - How Rust is Made and “Nightly Rust”</a></li></ol></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../../rust_by_example_src/index.html"><strong aria-hidden="true">5.</strong> Rust By Examples</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../rust_by_example_src/hello.html"><strong aria-hidden="true">5.1.</strong> Hello World</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../rust_by_example_src/hello/comment.html"><strong aria-hidden="true">5.1.1.</strong> Comments</a></li><li class="chapter-item "><a href="../../rust_by_example_src/hello/print.html"><strong aria-hidden="true">5.1.2.</strong> Formatted print</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../rust_by_example_src/hello/print/print_debug.html"><strong aria-hidden="true">5.1.2.1.</strong> Debug</a></li><li class="chapter-item "><a href="../../rust_by_example_src/hello/print/print_display.html"><strong aria-hidden="true">5.1.2.2.</strong> Display</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../rust_by_example_src/hello/print/print_display/testcase_list.html"><strong aria-hidden="true">5.1.2.2.1.</strong> Testcase: List</a></li></ol></li><li class="chapter-item "><a href="../../rust_by_example_src/hello/print/fmt.html"><strong aria-hidden="true">5.1.2.3.</strong> Formatting</a></li></ol></li></ol></li><li class="chapter-item "><div><strong aria-hidden="true">5.2.</strong> Types: Primitives, custom Types, Bindings and Change/Define/Advanced Conversion</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../rust_by_example_src/primitives.html"><strong aria-hidden="true">5.2.1.</strong> Primitives</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../rust_by_example_src/primitives/literals.html"><strong aria-hidden="true">5.2.1.1.</strong> Literals and operators</a></li><li class="chapter-item "><a href="../../rust_by_example_src/primitives/tuples.html"><strong aria-hidden="true">5.2.1.2.</strong> Tuples: a collection of values of different types</a></li><li class="chapter-item "><a href="../../rust_by_example_src/primitives/array.html"><strong aria-hidden="true">5.2.1.3.</strong> Arrays and Slices: a collection of objects of the same type T</a></li></ol></li><li class="chapter-item "><a href="../../rust_by_example_src/custom_types.html"><strong aria-hidden="true">5.2.2.</strong> Custom Types: struct and enum</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../rust_by_example_src/custom_types/structs.html"><strong aria-hidden="true">5.2.2.1.</strong> Structures: Tuple, C structs and Unit structs</a></li><li class="chapter-item "><a href="../../rust_by_example_src/custom_types/enum.html"><strong aria-hidden="true">5.2.2.2.</strong> ✨Enums: and Type alias</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../rust_by_example_src/custom_types/enum/enum_use.html"><strong aria-hidden="true">5.2.2.2.1.</strong> use</a></li><li class="chapter-item "><a href="../../rust_by_example_src/custom_types/enum/c_like.html"><strong aria-hidden="true">5.2.2.2.2.</strong> C-like</a></li><li class="chapter-item "><a href="../../rust_by_example_src/custom_types/enum/testcase_linked_list.html"><strong aria-hidden="true">5.2.2.2.3.</strong> Testcase: linked-list</a></li></ol></li><li class="chapter-item "><a href="../../rust_by_example_src/custom_types/constants.html"><strong aria-hidden="true">5.2.2.3.</strong> constants: const and static</a></li></ol></li><li class="chapter-item "><a href="../../rust_by_example_src/variable_bindings.html"><strong aria-hidden="true">5.2.3.</strong> Variable Bindings</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../rust_by_example_src/variable_bindings/mut.html"><strong aria-hidden="true">5.2.3.1.</strong> Mutability</a></li><li class="chapter-item "><a href="../../rust_by_example_src/variable_bindings/scope.html"><strong aria-hidden="true">5.2.3.2.</strong> Scope ({}) and Shadowing</a></li><li class="chapter-item "><a href="../../rust_by_example_src/variable_bindings/declare.html"><strong aria-hidden="true">5.2.3.3.</strong> Declare first</a></li><li class="chapter-item "><a href="../../rust_by_example_src/variable_bindings/freeze.html"><strong aria-hidden="true">5.2.3.4.</strong> Freezing</a></li></ol></li><li class="chapter-item "><a href="../../rust_by_example_src/types.html"><strong aria-hidden="true">5.2.4.</strong> 🚶Basic Conversion: Change or Define Types</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../rust_by_example_src/types/cast.html"><strong aria-hidden="true">5.2.4.1.</strong> as: Casting using as keyword</a></li><li class="chapter-item "><a href="../../rust_by_example_src/types/literals.html"><strong aria-hidden="true">5.2.4.2.</strong> Literals</a></li><li class="chapter-item "><a href="../../rust_by_example_src/types/inference.html"><strong aria-hidden="true">5.2.4.3.</strong> Inference</a></li><li class="chapter-item "><a href="../../rust_by_example_src/types/alias.html"><strong aria-hidden="true">5.2.4.4.</strong> ✨Type Aliasing: give a new name to an existing type</a></li></ol></li><li class="chapter-item "><a href="../../rust_by_example_src/conversion.html"><strong aria-hidden="true">5.2.5.</strong> 💃Advanced Conversion: From/Into trait</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../rust_by_example_src/conversion/from_into.html"><strong aria-hidden="true">5.2.5.1.</strong> From and Into</a></li><li class="chapter-item "><a href="../../rust_by_example_src/conversion/try_from_try_into.html"><strong aria-hidden="true">5.2.5.2.</strong> TryFrom and TryInto: used for fallible conversions, return Result</a></li><li class="chapter-item "><a href="../../rust_by_example_src/conversion/string.html"><strong aria-hidden="true">5.2.5.3.</strong> ToString and FromStr trait: To and from Strings</a></li></ol></li></ol></li><li class="chapter-item "><div><strong aria-hidden="true">5.3.</strong> Control: Statements, Functions and Error handling</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../rust_by_example_src/expression.html"><strong aria-hidden="true">5.3.1.</strong> ✨Expressions: statements end with ;</a></li><li class="chapter-item "><a href="../../rust_by_example_src/flow_control.html"><strong aria-hidden="true">5.3.2.</strong> 🧮 Flow of Control</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../rust_by_example_src/flow_control/if_else.html"><strong aria-hidden="true">5.3.2.1.</strong> if/else</a></li><li class="chapter-item "><a href="../../rust_by_example_src/flow_control/while.html"><strong aria-hidden="true">5.3.2.2.</strong> while</a></li><li class="chapter-item "><a href="../../rust_by_example_src/flow_control/loop.html"><strong aria-hidden="true">5.3.2.3.</strong> loop</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../rust_by_example_src/flow_control/loop/nested.html"><strong aria-hidden="true">5.3.2.3.1.</strong> Nesting and labels: a little like lifetime annotations</a></li><li class="chapter-item "><a href="../../rust_by_example_src/flow_control/loop/return.html"><strong aria-hidden="true">5.3.2.3.2.</strong> Returning from loops</a></li></ol></li><li class="chapter-item "><a href="../../rust_by_example_src/flow_control/if_let.html"><strong aria-hidden="true">5.3.2.4.</strong> if let</a></li><li class="chapter-item "><a href="../../rust_by_example_src/flow_control/while_let.html"><strong aria-hidden="true">5.3.2.5.</strong> ✨while_let</a></li><li class="chapter-item "><a href="../../rust_by_example_src/flow_control/for.html"><strong aria-hidden="true">5.3.2.6.</strong> for and range</a></li><li class="chapter-item "><a href="../../rust_by_example_src/flow_control/match.html"><strong aria-hidden="true">5.3.2.7.</strong> ⭐️match</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../rust_by_example_src/flow_control/match/destructuring.html"><strong aria-hidden="true">5.3.2.7.1.</strong> ✨✨✨Destructuring</a></li><li class="chapter-item "><a href="../../rust_by_example_src/flow_control/match/guard.html"><strong aria-hidden="true">5.3.2.7.2.</strong> Guards: to filter the arm</a></li><li class="chapter-item "><a href="../../rust_by_example_src/flow_control/match/binding.html"><strong aria-hidden="true">5.3.2.7.3.</strong> @ Binding</a></li></ol></li></ol></li><li class="chapter-item "><a href="../../rust_by_example_src/fn.html"><strong aria-hidden="true">5.3.3.</strong> ✨Functions</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../rust_by_example_src/fn/methods.html"><strong aria-hidden="true">5.3.3.1.</strong> Methods</a></li><li class="chapter-item "><a href="../../rust_by_example_src/fn/closures.html"><strong aria-hidden="true">5.3.3.2.</strong> ✨Closures</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../rust_by_example_src/fn/closures/capture.html"><strong aria-hidden="true">5.3.3.2.1.</strong> Capturing</a></li><li class="chapter-item "><div><strong aria-hidden="true">5.3.3.2.2.</strong> Fn/FnMut/FnOnce</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../rust_by_example_src/fn/closures/anonymity.html"><strong aria-hidden="true">5.3.3.2.2.1.</strong> Type anonymity</a></li><li class="chapter-item "><a href="../../rust_by_example_src/fn/closures/input_parameters.html"><strong aria-hidden="true">5.3.3.2.2.2.</strong> As input parameters</a></li><li class="chapter-item "><a href="../../rust_by_example_src/fn/closures/output_parameters.html"><strong aria-hidden="true">5.3.3.2.2.3.</strong> As output parameters</a></li><li class="chapter-item "><a href="../../rust_by_example_src/fn/closures/input_functions.html"><strong aria-hidden="true">5.3.3.2.2.4.</strong> Input functions</a></li></ol></li><li class="chapter-item "><a href="../../rust_by_example_src/fn/closures/closure_examples.html"><strong aria-hidden="true">5.3.3.2.3.</strong> Examples in std</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../rust_by_example_src/fn/closures/closure_examples/iter_any.html"><strong aria-hidden="true">5.3.3.2.3.1.</strong> Iterator::any</a></li><li class="chapter-item "><a href="../../rust_by_example_src/fn/closures/closure_examples/iter_find.html"><strong aria-hidden="true">5.3.3.2.3.2.</strong> Searching through iterators</a></li></ol></li></ol></li><li class="chapter-item "><a href="../../rust_by_example_src/fn/hof.html"><strong aria-hidden="true">5.3.3.3.</strong> Higher Order Functions</a></li><li class="chapter-item "><a href="../../rust_by_example_src/fn/diverging.html"><strong aria-hidden="true">5.3.3.4.</strong> ✨Diverging functions: return !, different from ()</a></li></ol></li><li class="chapter-item "><a href="../../rust_by_example_src/error.html"><strong aria-hidden="true">5.3.4.</strong> ⭐️Error handling: Panic、Option and Result</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../rust_by_example_src/error/panic.html"><strong aria-hidden="true">5.3.4.1.</strong> panic!: unrecoverable, try-exception</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../rust_by_example_src/error/abort_unwind.html"><strong aria-hidden="true">5.3.4.1.1.</strong> ✨abort & unwind: Two implementation mechanisms of panic</a></li></ol></li><li class="chapter-item "><a href="../../rust_by_example_src/error/option_unwrap.html"><strong aria-hidden="true">5.3.4.2.</strong> Option & unwrap</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../rust_by_example_src/error/option_unwrap/map.html"><strong aria-hidden="true">5.3.4.2.1.</strong> Combinators of Option: map</a></li><li class="chapter-item "><a href="../../rust_by_example_src/error/option_unwrap/and_then.html"><strong aria-hidden="true">5.3.4.2.2.</strong> Combinators of Option: and_then</a></li><li class="chapter-item "><a href="../../rust_by_example_src/error/option_unwrap/defaults.html"><strong aria-hidden="true">5.3.4.2.3.</strong> Defaults: or, or_else, get_or_insert, 'get_or_insert_with`</a></li></ol></li><li class="chapter-item "><a href="../../rust_by_example_src/error/result.html"><strong aria-hidden="true">5.3.4.3.</strong> Result & OK or ?: A Richer Version Of Option</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../rust_by_example_src/error/result/result_map.html"><strong aria-hidden="true">5.3.4.3.1.</strong> map for Result: catch explicit Exception and Continue</a></li><li class="chapter-item "><a href="../../rust_by_example_src/error/result/result_alias.html"><strong aria-hidden="true">5.3.4.3.2.</strong> Custom Exception: aliases for Result</a></li><li class="chapter-item "><a href="../../rust_by_example_src/error/result/early_returns.html"><strong aria-hidden="true">5.3.4.3.3.</strong> Early returns: Catch Exception and Return</a></li></ol></li><li class="chapter-item "><a href="../../#.html"><strong aria-hidden="true">5.3.4.4.</strong> ?: the uses of question mark</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../rust_by_example_src/error/result/enter_question_mark.html"><strong aria-hidden="true">5.3.4.4.1.</strong> Introducing ?</a></li><li class="chapter-item "><a href="../../rust_by_example_src/error/option_unwrap/question_mark.html"><strong aria-hidden="true">5.3.4.4.2.</strong> Unpacking options with ? to return the Some or terminate</a></li><li class="chapter-item "><a href="../../rust_by_example_src/error/multiple_error_types/reenter_question_mark.html"><strong aria-hidden="true">5.3.4.4.3.</strong> Other uses of ?</a></li></ol></li><li class="chapter-item "><a href="../../rust_by_example_src/error/multiple_error_types.html"><strong aria-hidden="true">5.3.4.5.</strong> Multiple error types to interact</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../rust_by_example_src/error/multiple_error_types/option_result.html"><strong aria-hidden="true">5.3.4.5.1.</strong> Pulling Results out of Options</a></li><li class="chapter-item "><a href="../../rust_by_example_src/error/multiple_error_types/define_error_type.html"><strong aria-hidden="true">5.3.4.5.2.</strong> Defining an error type</a></li><li class="chapter-item "><a href="../../rust_by_example_src/error/multiple_error_types/boxing_errors.html"><strong aria-hidden="true">5.3.4.5.3.</strong> Boxing errors</a></li><li class="chapter-item "><a href="../../rust_by_example_src/error/multiple_error_types/wrap_error.html"><strong aria-hidden="true">5.3.4.5.4.</strong> Wrapping errors</a></li></ol></li><li class="chapter-item "><a href="../../rust_by_example_src/error/iter_result.html"><strong aria-hidden="true">5.3.4.6.</strong> Iterating over Results</a></li><li class="chapter-item "><a href="../../rust_by_example_src/encapsulation_modules_crates_cargo.html"><strong aria-hidden="true">5.3.4.7.</strong> 📒Error Handling Practices -- ChatGPT</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../rust_by_example_src/error/error_handling_practices/basic_practics.html"><strong aria-hidden="true">5.3.4.7.1.</strong> Basic Practices</a></li></ol></li></ol></li></ol></li><li class="chapter-item "><a href="../../rust_by_example_src/encapsulation_modules_crates_cargo.html"><strong aria-hidden="true">5.4.</strong> Encapsulation: Modules, Crates and Cargo</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../rust_by_example_src/mod.html"><strong aria-hidden="true">5.4.1.</strong> Modules: hierarchically split and manage visibility</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../rust_by_example_src/mod/visibility.html"><strong aria-hidden="true">5.4.1.1.</strong> Visibility</a></li><li class="chapter-item "><a href="../../rust_by_example_src/mod/struct_visibility.html"><strong aria-hidden="true">5.4.1.2.</strong> Struct visibility: an extra level of visibility with their fields</a></li><li class="chapter-item "><a href="../../rust_by_example_src/mod/use.html"><strong aria-hidden="true">5.4.1.3.</strong> The use declaration: bind a full path to a new name</a></li><li class="chapter-item "><a href="../../rust_by_example_src/mod/super.html"><strong aria-hidden="true">5.4.1.4.</strong> super and self: remove ambiguity</a></li><li class="chapter-item "><a href="../../rust_by_example_src/mod/split.html"><strong aria-hidden="true">5.4.1.5.</strong> File/Directory hierarchy</a></li></ol></li><li class="chapter-item "><a href="../../rust_by_example_src/crates.html"><strong aria-hidden="true">5.4.2.</strong> Crates: compilation units in Rust, library or binary</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../rust_by_example_src/crates/lib.html"><strong aria-hidden="true">5.4.2.1.</strong> Creating a Library: --crate-type=lib</a></li><li class="chapter-item "><a href="../../rust_by_example_src/crates/using_lib.html"><strong aria-hidden="true">5.4.2.2.</strong> Using a Library: --extern</a></li></ol></li><li class="chapter-item "><a href="../../rust_by_example_src/cargo.html"><strong aria-hidden="true">5.4.3.</strong> Cargo: package management tool</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../rust_by_example_src/cargo/deps.html"><strong aria-hidden="true">5.4.3.1.</strong> Dependencies</a></li><li class="chapter-item "><a href="../../rust_by_example_src/cargo/conventions.html"><strong aria-hidden="true">5.4.3.2.</strong> Two Binaries Conventions</a></li><li class="chapter-item "><a href="../../rust_by_example_src/cargo/test.html"><strong aria-hidden="true">5.4.3.3.</strong> ✨Tests</a></li><li class="chapter-item "><a href="../../rust_by_example_src/cargo/build_scripts.html"><strong aria-hidden="true">5.4.3.4.</strong> Build Scripts</a></li></ol></li></ol></li><li class="chapter-item "><div><strong aria-hidden="true">5.5.</strong> Rust Core: Generics, Traits and Scoping</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../rust_by_example_src/generics.html"><strong aria-hidden="true">5.5.1.</strong> 🪐Generics</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../rust_by_example_src/generics/used_as_parameter.html"><strong aria-hidden="true">5.5.1.1.</strong> Used as Parameter</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../rust_by_example_src/generics/gen_fn.html"><strong aria-hidden="true">5.5.1.1.1.</strong> Functions: Identify whether a generic function</a></li><li class="chapter-item "><a href="../../rust_by_example_src/generics/impl.html"><strong aria-hidden="true">5.5.1.1.2.</strong> Impl Type fn: Identify whether a generic method</a></li><li class="chapter-item "><a href="../../rust_by_example_src/generics/gen_trait.html"><strong aria-hidden="true">5.5.1.1.3.</strong> Impl Traits fn: Identify whether a generic method</a></li></ol></li><li class="chapter-item "><a href="../../rust_by_example_src/generics/trait_bounds.html"><strong aria-hidden="true">5.5.1.2.</strong> Bounded by Trait</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../rust_by_example_src/generics/bounds/testcase_empty.html"><strong aria-hidden="true">5.5.1.2.1.</strong> ✨Testcase: empty bounds</a></li><li class="chapter-item "><a href="../../rust_by_example_src/generics/bounds/multi_trait_bounds.html"><strong aria-hidden="true">5.5.1.2.2.</strong> Multiple Trait Bounds</a></li><li class="chapter-item "><a href="../../rust_by_example_src/generics/bounds/where_bounds.html"><strong aria-hidden="true">5.5.1.2.3.</strong> Where clauses bounds</a></li></ol></li><li class="chapter-item "><a href="../../rust_by_example_src/generics/new_types.html"><strong aria-hidden="true">5.5.1.3.</strong> New Type Idiom</a></li><li class="chapter-item "><a href="../../rust_by_example_src/generics/assoc_items.html"><strong aria-hidden="true">5.5.1.4.</strong> ✨Associated items</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../rust_by_example_src/generics/assoc_items/the_problem.html"><strong aria-hidden="true">5.5.1.4.1.</strong> ✨The Problem</a></li><li class="chapter-item "><a href="../../rust_by_example_src/generics/assoc_items/types.html"><strong aria-hidden="true">5.5.1.4.2.</strong> Associated types</a></li></ol></li><li class="chapter-item "><a href="../../rust_by_example_src/generics/phantom.html"><strong aria-hidden="true">5.5.1.5.</strong> Phantom type parameters</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../rust_by_example_src/generics/phantom/testcase_units.html"><strong aria-hidden="true">5.5.1.5.1.</strong> Testcase: unit clarification</a></li></ol></li></ol></li><li class="chapter-item "><a href="../../rust_by_example_src/trait.html"><strong aria-hidden="true">5.5.2.</strong> 🪐Traits</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../rust_by_example_src/trait/derive.html"><strong aria-hidden="true">5.5.2.1.</strong> ✨Derive Macro Traits</a></li><li class="chapter-item "><a href="../../rust_by_example_src/trait/dyn.html"><strong aria-hidden="true">5.5.2.2.</strong> Returning Traits with dyn</a></li><li class="chapter-item "><a href="../../rust_by_example_src/trait/ops.html"><strong aria-hidden="true">5.5.2.3.</strong> Operator Overloading</a></li><li class="chapter-item "><a href="../../rust_by_example_src/trait/drop.html"><strong aria-hidden="true">5.5.2.4.</strong> Drop</a></li><li class="chapter-item "><a href="../../rust_by_example_src/trait/iter.html"><strong aria-hidden="true">5.5.2.5.</strong> Iterators: Iterator Trait</a></li><li class="chapter-item "><a href="../../rust_by_example_src/trait/impl_trait.html"><strong aria-hidden="true">5.5.2.6.</strong> ✨impl Trait</a></li><li class="chapter-item "><a href="../../rust_by_example_src/trait/supertraits.html"><strong aria-hidden="true">5.5.2.7.</strong> Supertraits</a></li><li class="chapter-item "><a href="../../rust_by_example_src/trait/disambiguating.html"><strong aria-hidden="true">5.5.2.8.</strong> Fully Qualified Syntax: Disambiguating overlapping traits</a></li></ol></li><li class="chapter-item "><a href="../../rust_by_example_src/scope.html"><strong aria-hidden="true">5.5.3.</strong> 🪐Scoping rules</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../rust_by_example_src/scope/raii.html"><strong aria-hidden="true">5.5.3.1.</strong> RAII</a></li><li class="chapter-item "><a href="../../rust_by_example_src/scope/move.html"><strong aria-hidden="true">5.5.3.2.</strong> Ownership and moves</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../rust_by_example_src/scope/move/mut.html"><strong aria-hidden="true">5.5.3.2.1.</strong> Mutability</a></li><li class="chapter-item "><a href="../../rust_by_example_src/scope/move/partial_move.html"><strong aria-hidden="true">5.5.3.2.2.</strong> Partial moves</a></li></ol></li><li class="chapter-item "><a href="../../rust_by_example_src/scope/borrow.html"><strong aria-hidden="true">5.5.3.3.</strong> Borrowing</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../rust_by_example_src/scope/borrow/mut.html"><strong aria-hidden="true">5.5.3.3.1.</strong> Mutability</a></li><li class="chapter-item "><a href="../../rust_by_example_src/scope/borrow/alias.html"><strong aria-hidden="true">5.5.3.3.2.</strong> Mutable or Immutable, Only One</a></li><li class="chapter-item "><a href="../../rust_by_example_src/scope/borrow/ref.html"><strong aria-hidden="true">5.5.3.3.3.</strong> ✨The ref pattern</a></li></ol></li><li class="chapter-item "><a href="../../rust_by_example_src/scope/lifetime.html"><strong aria-hidden="true">5.5.3.4.</strong> Lifetimes</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../rust_by_example_src/scope/lifetime/elision.html"><strong aria-hidden="true">5.5.3.4.1.</strong> Elision</a></li><li class="chapter-item "><a href="../../rust_by_example_src/scope/lifetime/explicit.html"><strong aria-hidden="true">5.5.3.4.2.</strong> ✨Explicit lifetime annotation: another Generic</a></li><li class="chapter-item "><a href="../../rust_by_example_src/scope/lifetime/fn_method_struct_trait.html"><strong aria-hidden="true">5.5.3.4.3.</strong> ✨Functions、methods、struct、trait</a></li><li class="chapter-item "><a href="../../rust_by_example_src/scope/lifetime/lifetime_bounds.html"><strong aria-hidden="true">5.5.3.4.4.</strong> Lifetime Bounds for generics</a></li><li class="chapter-item "><a href="../../rust_by_example_src/scope/lifetime/lifetime_coercion.html"><strong aria-hidden="true">5.5.3.4.5.</strong> Coercion</a></li><li class="chapter-item "><a href="../../rust_by_example_src/scope/lifetime/static_lifetime.html"><strong aria-hidden="true">5.5.3.4.6.</strong> Static</a></li></ol></li></ol></li></ol></li><li class="chapter-item "><div><strong aria-hidden="true">5.6.</strong> Macros: rules! and Attributes</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../rust_by_example_src/macros.html"><strong aria-hidden="true">5.6.1.</strong> macro_rules!</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../rust_by_example_src/macros/syntax.html"><strong aria-hidden="true">5.6.1.1.</strong> Syntax</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../rust_by_example_src/macros/designators.html"><strong aria-hidden="true">5.6.1.1.1.</strong> Designators</a></li><li class="chapter-item "><a href="../../rust_by_example_src/macros/overload.html"><strong aria-hidden="true">5.6.1.1.2.</strong> Overload</a></li><li class="chapter-item "><a href="../../rust_by_example_src/macros/repeat.html"><strong aria-hidden="true">5.6.1.1.3.</strong> Repeat</a></li></ol></li><li class="chapter-item "><a href="../../rust_by_example_src/macros/dry.html"><strong aria-hidden="true">5.6.1.2.</strong> DRY (rust_by_example_src/Don't Repeat Yourself)</a></li><li class="chapter-item "><a href="../../rust_by_example_src/macros/dsl.html"><strong aria-hidden="true">5.6.1.3.</strong> DSL (rust_by_example_src/Domain Specific Languages)</a></li><li class="chapter-item "><a href="../../rust_by_example_src/macros/variadics.html"><strong aria-hidden="true">5.6.1.4.</strong> Variadics</a></li></ol></li><li class="chapter-item "><a href="../../rust_by_example_src/attribute.html"><strong aria-hidden="true">5.6.2.</strong> 🧐 Attributes: metadata applied to some module, crate or item</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../rust_by_example_src/attribute/unused.html"><strong aria-hidden="true">5.6.2.1.</strong> dead_code: disable the unused lint</a></li><li class="chapter-item "><a href="../../rust_by_example_src/attribute/crate.html"><strong aria-hidden="true">5.6.2.2.</strong> Crates: : crate_type and crate_name</a></li><li class="chapter-item "><a href="../../rust_by_example_src/attribute/cfg.html"><strong aria-hidden="true">5.6.2.3.</strong> cfg: Configuration conditional checks</a></li><li class="chapter-item "><a href="../../rust_by_example_src/attribute/cfg/custom.html"><strong aria-hidden="true">5.6.2.4.</strong> Custom: Custom conditionals</a></li></ol></li></ol></li><li class="chapter-item "><div><strong aria-hidden="true">5.7.</strong> Std: Library types and Misc</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../rust_by_example_src/std.html"><strong aria-hidden="true">5.7.1.</strong> ⭐️Std library types</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../rust_by_example_src/std/box.html"><strong aria-hidden="true">5.7.1.1.</strong> ✨Box, stack and heap</a></li><li class="chapter-item "><a href="../../rust_by_example_src/std/vec.html"><strong aria-hidden="true">5.7.1.2.</strong> ✨Vectors: re-sizable arrays</a></li><li class="chapter-item "><a href="../../rust_by_example_src/std/str.html"><strong aria-hidden="true">5.7.1.3.</strong> ✨Strings: String and &str</a></li><li class="chapter-item "><a href="../../rust_by_example_src/std/panic.html"><strong aria-hidden="true">5.7.1.4.</strong> panic!: Raise Exception , no Catch</a></li><li class="chapter-item "><a href="../../rust_by_example_src/std/option.html"><strong aria-hidden="true">5.7.1.5.</strong> Option: catching failure instead of calling panic!</a></li><li class="chapter-item "><a href="../../rust_by_example_src/std/result.html"><strong aria-hidden="true">5.7.1.6.</strong> Result: express why an operation failed</a></li><li class="chapter-item "><a href="../../rust_by_example_src/std/result/question_mark.html"><strong aria-hidden="true">5.7.1.7.</strong> ?: Chaining Results only match Ok(ok)</a></li><li class="chapter-item "><a href="../../rust_by_example_src/std/hash.html"><strong aria-hidden="true">5.7.1.8.</strong> HashMap</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../rust_by_example_src/std/hash/alt_key_types.html"><strong aria-hidden="true">5.7.1.8.1.</strong> Alternate/custom key types</a></li><li class="chapter-item "><a href="../../rust_by_example_src/std/hash/hashset.html"><strong aria-hidden="true">5.7.1.8.2.</strong> HashSet</a></li></ol></li><li class="chapter-item "><a href="../../rust_by_example_src/std/rc.html"><strong aria-hidden="true">5.7.1.9.</strong> Rc: for mutiple ownership, just like what python have done</a></li><li class="chapter-item "><a href="../../rust_by_example_src/std/arc.html"><strong aria-hidden="true">5.7.1.10.</strong> Arc: shared ownership between threads</a></li></ol></li><li class="chapter-item "><a href="../../rust_by_example_src/std_misc.html"><strong aria-hidden="true">5.7.2.</strong> 🌌 Std misc</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../rust_by_example_src/std_misc/threads.html"><strong aria-hidden="true">5.7.2.1.</strong> Threads</a></li><li class="chapter-item "><a href="../../rust_by_example_src/std_misc/threads/testcase_mapreduce.html"><strong aria-hidden="true">5.7.2.2.</strong> ✨Testcase: map-reduce</a></li><li class="chapter-item "><a href="../../rust_by_example_src/std_misc/channels.html"><strong aria-hidden="true">5.7.2.3.</strong> Channels: Asynchronous communication between threads</a></li><li class="chapter-item "><a href="../../rust_by_example_src/std_misc/path.html"><strong aria-hidden="true">5.7.2.4.</strong> Path</a></li><li class="chapter-item "><a href="../../rust_by_example_src/std_misc/file.html"><strong aria-hidden="true">5.7.2.5.</strong> File I/O</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../rust_by_example_src/std_misc/file/open.html"><strong aria-hidden="true">5.7.2.5.1.</strong> open: read-only</a></li><li class="chapter-item "><a href="../../rust_by_example_src/std_misc/file/create.html"><strong aria-hidden="true">5.7.2.5.2.</strong> create: write-only</a></li><li class="chapter-item "><a href="../../rust_by_example_src/std_misc/file/read_lines.html"><strong aria-hidden="true">5.7.2.5.3.</strong> read lines: returns an iterator</a></li></ol></li><li class="chapter-item "><a href="../../rust_by_example_src/std_misc/process.html"><strong aria-hidden="true">5.7.2.6.</strong> Child processes</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../rust_by_example_src/std_misc/process/pipe.html"><strong aria-hidden="true">5.7.2.6.1.</strong> Pipes: interaction with the underlying process</a></li><li class="chapter-item "><a href="../../rust_by_example_src/std_misc/process/wait.html"><strong aria-hidden="true">5.7.2.6.2.</strong> Wait</a></li></ol></li><li class="chapter-item "><a href="../../rust_by_example_src/std_misc/fs.html"><strong aria-hidden="true">5.7.2.7.</strong> std::fs: Filesystem Operations</a></li><li class="chapter-item "><a href="../../rust_by_example_src/std_misc/arg.html"><strong aria-hidden="true">5.7.2.8.</strong> Program arguments</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../rust_by_example_src/std_misc/arg/matching.html"><strong aria-hidden="true">5.7.2.8.1.</strong> Match to Argument parsing</a></li></ol></li><li class="chapter-item "><a href="../../rust_by_example_src/std_misc/ffi.html"><strong aria-hidden="true">5.7.2.9.</strong> FFI: Foreign Function Interface</a></li></ol></li></ol></li><li class="chapter-item "><div><strong aria-hidden="true">5.8.</strong> Misc: Testing, Unsafe, Compatibility and Meta</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../rust_by_example_src/testing.html"><strong aria-hidden="true">5.8.1.</strong> Testing</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../rust_by_example_src/testing/unit_testing.html"><strong aria-hidden="true">5.8.1.1.</strong> ✨Unit testing for panic: #[cfg(test)], #[test], #[should_panic], #[ignore]</a></li><li class="chapter-item "><a href="../../rust_by_example_src/meta/doc.html"><strong aria-hidden="true">5.8.1.2.</strong> Documentation: cargo doc</a></li><li class="chapter-item "><a href="../../rust_by_example_src/testing/doc_testing.html"><strong aria-hidden="true">5.8.1.3.</strong> ⭐️Documentation testing</a></li><li class="chapter-item "><a href="../../rust_by_example_src/testing/integration_testing.html"><strong aria-hidden="true">5.8.1.4.</strong> Integration testing</a></li><li class="chapter-item "><a href="../../rust_by_example_src/testing/dev_dependencies.html"><strong aria-hidden="true">5.8.1.5.</strong> Dev-dependencies</a></li></ol></li><li class="chapter-item "><a href="../../rust_by_example_src/unsafe.html"><strong aria-hidden="true">5.8.2.</strong> Unsafe Operations</a></li><li class="chapter-item "><a href="../../rust_by_example_src/unsafe/asm.html"><strong aria-hidden="true">5.8.3.</strong> 🤔️asm!: Inline assembly in Unsafe</a></li><li class="chapter-item "><a href="../../rust_by_example_src/compatibility.html"><strong aria-hidden="true">5.8.4.</strong> Compatibility</a></li><li class="chapter-item "><a href="../../rust_by_example_src/compatibility/raw_identifiers.html"><strong aria-hidden="true">5.8.5.</strong> Raw identifiers: r#</a></li><li class="chapter-item "><a href="../../rust_by_example_src/meta.html"><strong aria-hidden="true">5.8.6.</strong> Meta</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../rust_by_example_src/meta/playground.html"><strong aria-hidden="true">5.8.6.1.</strong> Playground</a></li></ol></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../../PyO3_guides/src/index.html"><strong aria-hidden="true">6.</strong> The PyO3 Guide</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../PyO3_guides/src/getting_started.html"><strong aria-hidden="true">6.1.</strong> Getting started</a></li><li class="chapter-item "><a href="../../PyO3_guides/src/module.html"><strong aria-hidden="true">6.2.</strong> Python modules</a></li><li class="chapter-item "><a href="../../PyO3_guides/src/function.html"><strong aria-hidden="true">6.3.</strong> Python functions</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../PyO3_guides/src/function/signature.html"><strong aria-hidden="true">6.3.1.</strong> Function signatures</a></li><li class="chapter-item "><a href="../../PyO3_guides/src/function/error_handling.html"><strong aria-hidden="true">6.3.2.</strong> Error handling</a></li></ol></li><li class="chapter-item "><a href="../../PyO3_guides/src/class.html"><strong aria-hidden="true">6.4.</strong> Python classes</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../PyO3_guides/src/class/protocols.html"><strong aria-hidden="true">6.4.1.</strong> Class customizations</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../PyO3_guides/src/class/object.html"><strong aria-hidden="true">6.4.1.1.</strong> Basic object customization</a></li><li class="chapter-item "><a href="../../PyO3_guides/src/class/numeric.html"><strong aria-hidden="true">6.4.1.2.</strong> Emulating numeric types</a></li><li class="chapter-item "><a href="../../PyO3_guides/src/class/call.html"><strong aria-hidden="true">6.4.1.3.</strong> Emulating callable objects</a></li></ol></li></ol></li><li class="chapter-item "><a href="../../PyO3_guides/src/conversions.html"><strong aria-hidden="true">6.5.</strong> Type conversions</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../PyO3_guides/src/conversions/tables.html"><strong aria-hidden="true">6.5.1.</strong> Mapping of Rust types to Python types</a></li><li class="chapter-item "><a href="../../PyO3_guides/src/conversions/traits.html"><strong aria-hidden="true">6.5.2.</strong> Conversion traits</a></li></ol></li><li class="chapter-item "><a href="../../PyO3_guides/src/exception.html"><strong aria-hidden="true">6.6.</strong> Python exceptions</a></li><li class="chapter-item "><a href="../../PyO3_guides/src/python_from_rust.html"><strong aria-hidden="true">6.7.</strong> Calling Python from Rust</a></li><li class="chapter-item "><a href="../../PyO3_guides/src/types.html"><strong aria-hidden="true">6.8.</strong> GIL, mutability and object types</a></li><li class="chapter-item "><a href="../../PyO3_guides/src/parallelism.html"><strong aria-hidden="true">6.9.</strong> Parallelism</a></li><li class="chapter-item "><a href="../../PyO3_guides/src/debugging.html"><strong aria-hidden="true">6.10.</strong> Debugging</a></li><li class="chapter-item "><a href="../../PyO3_guides/src/features.html"><strong aria-hidden="true">6.11.</strong> Features reference</a></li><li class="chapter-item "><a href="../../PyO3_guides/src/memory.html"><strong aria-hidden="true">6.12.</strong> Memory management</a></li><li class="chapter-item "><a href="../../PyO3_guides/src/advanced.html"><strong aria-hidden="true">6.13.</strong> Advanced topics</a></li><li class="chapter-item "><a href="../../PyO3_guides/src/building_and_distribution.html"><strong aria-hidden="true">6.14.</strong> ⭐️Building and distribution</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../PyO3_guides/src/building_and_distribution/multiple_python_versions.html"><strong aria-hidden="true">6.14.1.</strong> Supporting multiple Python versions</a></li></ol></li><li class="chapter-item "><a href="../../PyO3_guides/src/ecosystem.html"><strong aria-hidden="true">6.15.</strong> Useful crates</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../PyO3_guides/src/ecosystem/logging.html"><strong aria-hidden="true">6.15.1.</strong> Logging</a></li><li class="chapter-item "><a href="../../PyO3_guides/src/ecosystem/async-await.html"><strong aria-hidden="true">6.15.2.</strong> Using async and await</a></li></ol></li><li class="chapter-item "><a href="../../PyO3_guides/src/faq.html"><strong aria-hidden="true">6.16.</strong> FAQ and troubleshooting</a></li><li class="chapter-item "><a href="../../PyO3_guides/src/migration.html"><strong aria-hidden="true">6.17.</strong> Appendix A: Migration guide</a></li><li class="chapter-item "><a href="../../PyO3_guides/src/rust_cpython.html"><strong aria-hidden="true">6.18.</strong> Appendix B: PyO3 and rust-cpython</a></li><li class="chapter-item "><a href="../../PyO3_guides/src/trait_bounds.html"><strong aria-hidden="true">6.19.</strong> Appendix C: Trait bounds</a></li><li class="chapter-item "><a href="../../PyO3_guides/src/python_typing_hints.html"><strong aria-hidden="true">6.20.</strong> Appendix D: Python typing hints</a></li><li class="chapter-item "><a href="../../PyO3_guides/src/changelog.html"><strong aria-hidden="true">6.21.</strong> CHANGELOG</a></li><li class="chapter-item "><a href="../../PyO3_guides/src/contributing.html"><strong aria-hidden="true">6.22.</strong> Contributing</a></li></ol></li><li class="chapter-item expanded "><a href="../../checklist.html">Checklist</a></li></ol>
    </div>
    <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
</nav>

<div id="page-wrapper" class="page-wrapper">

    <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
        <div id="menu-bar" class="menu-bar sticky bordered">
            <div class="left-buttons">
                <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents"
                        aria-label="Toggle Table of Contents" aria-controls="sidebar">
                    <i class="fa fa-bars"></i>
                </button>
                <button id="theme-toggle" class="icon-button" type="button" title="Change theme"
                        aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                    <i class="fa fa-paint-brush"></i>
                </button>
                <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                    <li role="none">
                        <button role="menuitem" class="theme" id="light">Light</button>
                    </li>
                    <li role="none">
                        <button role="menuitem" class="theme" id="rust">Rust</button>
                    </li>
                    <li role="none">
                        <button role="menuitem" class="theme" id="coal">Coal</button>
                    </li>
                    <li role="none">
                        <button role="menuitem" class="theme" id="navy">Navy (default)</button>
                    </li>
                    <li role="none">
                        <button role="menuitem" class="theme" id="ayu">Ayu</button>
                    </li>
                </ul>
                    <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)"
                            aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S"
                            aria-controls="searchbar">
                        <i class="fa fa-search"></i>
                    </button>
            </div>

            <h1 class="menu-title">The Rust Programming Language</h1>
            <h4 class="menu-bar">日不见增 月有渐进 | 唯剃真我 方有成效｜ 惊涛拍案 千层雪起 | <a href="https://kuanhsiaokuo.github.io/think-tool-kit/">保持批判，有所取舍 | 知行合一, 方见真我</a> | 练武不练功
                到头一场空 -- 《赛博英雄传》 </h4>
            <div class="right-buttons">
                    <a href="../../print.html" title="Print this book" aria-label="Print this book">
                        <i id="print-button" class="fa fa-print"></i>
                    </a>
                    <a href="https://github.com/rust-lang/book" title="Git repository" aria-label="Git repository">
                        <i id="git-repository-button" class="fa fa-github"></i>
                    </a>
            </div>
        </div>

            <div id="search-wrapper" class="hidden">
                <form id="searchbar-outer" class="searchbar-outer">
                    <input type="search" name="search" id="searchbar" name="searchbar"
                           placeholder="Search this book ..." aria-controls="searchresults-outer"
                           aria-describedby="searchresults-header">
                </form>
                <div id="searchresults-outer" class="searchresults-outer hidden">
                    <div id="searchresults-header" class="searchresults-header"></div>
                    <ul id="searchresults">
                    </ul>
                </div>
            </div>

        <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
        <script type="text/javascript">
            document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
            document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
            Array.from(document.querySelectorAll('#sidebar a')).forEach(function (link) {
                link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
            });
        </script>

        <div id="content" class="content">
            <main>

                <!-- Page table of contents -->
                <div class="sidetoc">
                    <nav class="pagetoc"></nav>
                </div>
                <h1 id="smart-pointers-and-interior-mutability"><a class="header" href="#smart-pointers-and-interior-mutability">Smart Pointers and Interior Mutability</a></h1>
<!--ts-->
<ul>
<li><a href="#smart-pointers-and-interior-mutability">Smart Pointers and Interior Mutability</a>
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#overview-of-smart-pointers">Overview of Smart Pointers</a>
<ul>
<li><a href="#common-smart-pointer-types">Common Smart Pointer Types</a></li>
</ul>
</li>
<li><a href="#implementation-of-smart-pointers">Implementation of Smart Pointers</a>
<ul>
<li><a href="#implementing-smart-pointer-types">Implementing Smart Pointer Types</a></li>
</ul>
</li>
<li><a href="#resources-for-learning-more-about-rust">Resources for Learning More About Rust</a>
<ul>
<li><a href="#resources-for-learning-more-about-rust-1">Resources for Learning More About Rust</a></li>
</ul>
</li>
<li><a href="#introduction-to-cell">Introduction to Cell</a>
<ul>
<li><a href="#introduction-to-cell-1">Introduction to Cell</a></li>
</ul>
</li>
<li><a href="#starting-with-sell">Starting with Sell</a>
<ul>
<li><a href="#starting-with-sell-1">Starting with Sell</a></li>
</ul>
</li>
<li><a href="#interior-mutability-and-cell">Interior Mutability and Cell</a>
<ul>
<li><a href="#introduction-to-cell-2">Introduction to Cell</a></li>
<li><a href="#restrictions-of-cell-types">Restrictions of Cell Types</a></li>
<li><a href="#safety-features-of-cell">Safety Features of Cell</a></li>
<li><a href="#borrowing-and-exclusive-reference">Borrowing and Exclusive Reference</a></li>
<li><a href="#benefits-of-using-cell">Benefits of Using Cell</a></li>
<li><a href="#usage-of-cell">Usage of Cell</a></li>
<li><a href="#basic-api">Basic API</a></li>
<li><a href="#unsafe-cell">Unsafe Cell</a></li>
</ul>
</li>
<li><a href="#introduction-to-unsafe-cell">Introduction to Unsafe Cell</a>
<ul>
<li><a href="#using-unsafe-cell">Using Unsafe Cell</a></li>
<li><a href="#implementing-not-sync-for-cell-t">Implementing Not Sync for Cell T</a></li>
</ul>
</li>
<li><a href="#recap-of-unsafe-cell">Recap of Unsafe Cell</a>
<ul>
<li><a href="#summary-of-unsafe-cell">Summary of Unsafe Cell</a></li>
<li><a href="#using-cell-to-get-a-reference">Using Cell to Get a Reference</a></li>
<li><a href="#disallowing-unsafe-implementation-of-sync">Disallowing Unsafe Implementation of Sync</a></li>
<li><a href="#demonstrating-broken-code-with-multiple-threads">Demonstrating Broken Code with Multiple Threads</a></li>
</ul>
</li>
<li><a href="#the-problem-with-interleaving-threads">The Problem with Interleaving Threads</a>
<ul>
<li><a href="#interleaving-threads">Interleaving Threads</a></li>
<li><a href="#demonstrating-the-problem">Demonstrating the Problem</a></li>
</ul>
</li>
<li><a href="#non-copy-types-and-trait-bounds">Non-Copy Types and Trait Bounds</a>
<ul>
<li><a href="#copy-trait-requirement">Copy Trait Requirement</a></li>
<li><a href="#constrained-trait-bounds">Constrained Trait Bounds</a></li>
</ul>
</li>
<li><a href="#unsafe-cell-and-ref-cell">Unsafe Cell and Ref Cell</a>
<ul>
<li><a href="#unsafe-cell-1">Unsafe Cell</a></li>
<li><a href="#ref-cell">Ref Cell</a></li>
<li><a href="#borrowing-with-refcell-and-cell">Borrowing with RefCell and Cell</a></li>
<li><a href="#using-cell-instead-of-refcell">Using Cell instead of RefCell</a></li>
<li><a href="#safety-argument">Safety Argument</a></li>
</ul>
</li>
<li><a href="#ref-type">Ref Type</a>
<ul>
<li><a href="#implementation-of-ref-type">Implementation of Ref Type</a></li>
<li><a href="#deref-trait">Deref Trait</a></li>
<li><a href="#safety-argument-1">Safety Argument</a></li>
</ul>
</li>
<li><a href="#refcell-and-rc">RefCell and Rc</a>
<ul>
<li><a href="#refcell">RefCell</a></li>
<li><a href="#rc">RC</a></li>
</ul>
</li>
<li><a href="#rc-and-smart-pointers">RC and Smart Pointers</a>
<ul>
<li><a href="#weak-vs-strong-pointers">Weak vs Strong Pointers</a></li>
<li><a href="#introduction-to-rc-smart-pointers">Introduction to RC Smart Pointers</a></li>
<li><a href="#implementing-clone-for-t">Implementing Clone for T</a></li>
</ul>
</li>
<li><a href="#rust-reference-types">Rust Reference Types</a>
<ul>
<li><a href="#reference-types">Reference Types</a></li>
</ul>
</li>
<li><a href="#box-in-rust">Box in Rust</a>
<ul>
<li><a href="#box-provides-heap-allocation">Box Provides Heap Allocation</a></li>
</ul>
</li>
<li><a href="#unsafe-keyword-in-rust">Unsafe Keyword in Rust</a>
<ul>
<li><a href="#unsafe-keyword">Unsafe Keyword</a></li>
</ul>
</li>
<li><a href="#smart-pointers-in-rust">Smart Pointers in Rust</a>
<ul>
<li><a href="#deallocating-smart-pointers">Deallocating Smart Pointers</a></li>
</ul>
</li>
<li><a href="#understanding-variance-in-rust">Understanding Variance in Rust</a>
<ul>
<li><a href="#variance-in-rust">Variance in Rust</a></li>
<li><a href="#using-non-null">Using Non-Null</a></li>
</ul>
</li>
<li><a href="#using-unsafe-pointers-in-rust">Using Unsafe Pointers in Rust</a>
<ul>
<li><a href="#using-unsafe-rf-method-on-non-null">Using Unsafe RF Method on Non Null</a></li>
<li><a href="#why-unsafe-pointers-are-necessary">Why Unsafe Pointers are Necessary</a></li>
</ul>
</li>
<li><a href="#lifetime-guarantees-in-rust">Lifetime Guarantees in Rust</a>
<ul>
<li><a href="#why-you-cannot-store-mutable-references-outside-their-scope">Why You Cannot Store Mutable References Outside Their Scope</a></li>
<li><a href="#difference-between-mutable-pointer-and-mutable-reference">Difference Between Mutable Pointer and Mutable Reference</a></li>
</ul>
</li>
<li><a href="#understanding-memory-in-rust">Understanding Memory in Rust</a>
<ul>
<li><a href="#why-a-cell-is-necessary-even-if-there-is-a-mutable-pointer">Why a Cell is Necessary Even if There is a Mutable Pointer</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#inner-dog-ref-count">Inner Dog Ref Count</a>
<ul>
<li><a href="#importance-of-marker-in-rust">Importance of Marker in Rust</a></li>
<li><a href="#drop-check-in-rust">Drop Check in Rust</a></li>
<li><a href="#example-of-drop-check-issue">Example of Drop Check Issue</a></li>
</ul>
</li>
<li><a href="#understanding-drop-check">Understanding Drop Check</a>
<ul>
<li><a href="#how-drop-check-works">How Drop Check Works</a></li>
<li><a href="#example-of-drop-check-issue-1">Example of Drop Check Issue</a></li>
</ul>
</li>
<li><a href="#understanding-phantom-data-in-rust">Understanding Phantom Data in Rust</a>
<ul>
<li><a href="#phantom-data">Phantom Data</a></li>
<li><a href="#question-mark-sized-types">Question Mark Sized Types</a></li>
<li><a href="#benefits-of-using-rust-over-c">Benefits of Using Rust Over C</a></li>
</ul>
</li>
<li><a href="#refcell-mutex-and-arc">RefCell, Mutex and Arc</a>
<ul>
<li><a href="#exclamation-marks-sized-vs-question-mark-sized">Exclamation Marks Sized vs Question Mark Sized</a></li>
<li><a href="#synchronous-versions-of-refcell-mutex-and-arc">Synchronous Versions of RefCell, Mutex and Arc</a></li>
</ul>
</li>
<li><a href="#rc-vs-art">RC vs Art</a>
<ul>
<li><a href="#cost-of-using-atomics">Cost of Using Atomics</a></li>
<li><a href="#asynchronous-mutexes">Asynchronous Mutexes</a></li>
</ul>
</li>
<li><a href="#the-cow-type">The Cow Type</a>
<ul>
<li><a href="#copy-on-write">Copy-On-Write</a></li>
<li><a href="#benefits-of-cow-type">Benefits of Cow Type</a></li>
</ul>
</li>
<li><a href="#example-escape-function-with-cow-type">Example: Escape Function with Cow Type</a>
<ul>
<li><a href="#escaping-function-with-string-input">Escaping Function with String Input</a></li>
</ul>
</li>
<li><a href="#from-utf-8-lossy">From Utf-8 Lossy</a>
<ul>
<li><a href="#from-utf-8-lossy-1">From Utf-8 Lossy</a></li>
</ul>
</li>
<li><a href="#cow-type-and-smart-pointers">Cow Type and Smart Pointers</a>
<ul>
<li><a href="#cow-type">Cow Type</a></li>
<li><a href="#smart-pointers">Smart Pointers</a></li>
</ul>
</li>
<li><a href="#recap-and-next-steps">Recap and Next Steps</a>
<ul>
<li><a href="#recap">Recap</a></li>
<li><a href="#next-steps">Next Steps</a></li>
<li><a href="#generated-by-video-highlight">Generated by Video Highlight</a></li>
</ul>
</li>
</ul>
<!-- Created by https://github.com/ekalinin/github-markdown-toc -->
<!-- Added by: runner, at: Wed Apr 12 04:59:12 UTC 2023 -->
<!--te-->
<h2 id="introduction"><a class="header" href="#introduction">Introduction</a></h2>
<p>Section Overview: In this section, the speaker introduces the topic of smart pointers and interior mutability in Rust.
They discuss some of the types that are commonly used in Rust, such as arc, RC, refs, l mutex L, DRF, as ref traits,
Baro trait, cow and sized.</p>
<ul>
<li>The speaker also provides information on where to find recordings of their streams and how to get announcements for
upcoming streams.</li>
<li>They introduce a new sub-channel on the Rust Asian Station Discord server called Rotation Station which is intended to
be a community podcast for Rust.</li>
</ul>
<h2 id="overview-of-smart-pointers"><a class="header" href="#overview-of-smart-pointers">Overview of Smart Pointers</a></h2>
<p>Section Overview: In this section, the speaker discusses some of the common smart pointer types in Rust.</p>
<h3 id="common-smart-pointer-types"><a class="header" href="#common-smart-pointer-types">Common Smart Pointer Types</a></h3>
<ul>
<li>The speaker mentions several common smart pointer types in Rust: arc, RC, refs, l mutex L, DRF and as ref traits.</li>
<li>They explain that these types are pervasive in Rust and it’s important to have knowledge about them.</li>
<li>The speaker also mentions other types like cow and sized if they have time to cover them.</li>
</ul>
<h2 id="implementation-of-smart-pointers"><a class="header" href="#implementation-of-smart-pointers">Implementation of Smart Pointers</a></h2>
<p>Section Overview: In this section, the speaker talks about implementing some of the common smart pointer types
themselves.</p>
<h3 id="implementing-smart-pointer-types"><a class="header" href="#implementing-smart-pointer-types">Implementing Smart Pointer Types</a></h3>
<ul>
<li>The speaker explains that they will be implementing RC ref sell and sell.</li>
<li>They mention that they may also discuss Arc Mutex Ref Borrow Cow Bull CFD if there is time.</li>
<li>The implementation will help viewers understand intermediate concepts in Rust.</li>
</ul>
<h2 id="resources-for-learning-more-about-rust"><a class="header" href="#resources-for-learning-more-about-rust">Resources for Learning More About Rust</a></h2>
<p>Section Overview: In this section, the speaker provides resources for learning more about Rust.</p>
<h3 id="resources-for-learning-more-about-rust-1"><a class="header" href="#resources-for-learning-more-about-rust-1">Resources for Learning More About Rust</a></h3>
<ul>
<li>The speaker mentions that all recordings are posted on YouTube after each stream.</li>
<li>They encourage viewers to follow them on Twitter for announcements and input on episodes.</li>
<li>The speaker also mentions that they have longer programming videos available on their YouTube channel.</li>
</ul>
<h2 id="introduction-to-cell"><a class="header" href="#introduction-to-cell">Introduction to Cell</a></h2>
<p>Section Overview: In this section, the speaker introduces the Rust standard library module called Cell.</p>
<h3 id="introduction-to-cell-1"><a class="header" href="#introduction-to-cell-1">Introduction to Cell</a></h3>
<ul>
<li>The speaker explains that the Cell module is a shareable mutable container.</li>
<li>They mention that this might sound weird in Rust because of its shared reference and exclusive reference concepts.</li>
<li>However, the module allows for interior mutability in a controlled fashion under certain constraints.</li>
</ul>
<h2 id="starting-with-sell"><a class="header" href="#starting-with-sell">Starting with Sell</a></h2>
<p>Section Overview: In this section, the speaker talks about starting with Sell since it has the least amount of
quirkiness among the smart pointer types.</p>
<h3 id="starting-with-sell-1"><a class="header" href="#starting-with-sell-1">Starting with Sell</a></h3>
<ul>
<li>The speaker explains that they will start with Sell since it’s less quirky than other smart pointer types.</li>
<li>They mention that there are various container types in Rust’s standard library that allow for interior mutability.</li>
<li>These containers are often referred to as shareable mutable containers or interior immutability.</li>
</ul>
<h2 id="interior-mutability-and-cell"><a class="header" href="#interior-mutability-and-cell">Interior Mutability and Cell</a></h2>
<p>Section Overview: In this section, the speaker discusses interior mutability and exclusive or shared references. They
then introduce the concept of a cell in Rust.</p>
<h3 id="introduction-to-cell-2"><a class="header" href="#introduction-to-cell-2">Introduction to Cell</a></h3>
<ul>
<li>A cell provides interior mutability in Rust.</li>
<li>You can create a new cell with a value of some type T.</li>
<li>The set method allows you to change the value inside the cell using an immutable reference.</li>
<li>The swap method lets you swap values between two cells.</li>
<li>The replace method replaces the value inside the cell with a new one.</li>
<li>The into_inner method consumes self, assuming ownership of the cell.</li>
</ul>
<h3 id="restrictions-of-cell-types"><a class="header" href="#restrictions-of-cell-types">Restrictions of Cell Types</a></h3>
<ul>
<li>Different types of cells have different restrictions on what can be stored inside them and how they can be used.</li>
<li>As you move towards mutex, there is more freedom to store whatever you want but also more overhead involved in making
it work.</li>
<li>Box does not provide interior mutability. If you have a shared reference to a box, you cannot mutate its contents.</li>
<li>There is no way to tell externally from a type whether it has interior mutability.</li>
</ul>
<h3 id="safety-features-of-cell"><a class="header" href="#safety-features-of-cell">Safety Features of Cell</a></h3>
<ul>
<li>With Cell, there is no way to get a reference to what’s inside the cell itself. This means that if no one else has a
pointer to the value stored in the cell, changing it is safe.</li>
<li>Cell does not implement sync. This means that if you have a reference to a cell, you cannot give away that reference
to another thread.</li>
</ul>
<h2 id="why-cant-we-borrow-mewtwo-more-than-once-for-rc"><a class="header" href="#why-cant-we-borrow-mewtwo-more-than-once-for-rc"><a href="t=0:10:59s">#</a> Why can’t we borrow Mewtwo more than once for RC?</a></h2>
<p>Section Overview: In this section, the speaker explains why it is not possible to borrow Mewtwo more than once for RC.</p>
<h3 id="borrowing-and-exclusive-reference"><a class="header" href="#borrowing-and-exclusive-reference">Borrowing and Exclusive Reference</a></h3>
<ul>
<li><a href="t=0:10:59s"></a> You cannot use an exclusive reference in general with a cell.</li>
<li>If you have an exclusive reference to the cell, you can get an exclusive reference to the value inside.</li>
<li>At that point, you cannot get or change the value.</li>
</ul>
<h3 id="benefits-of-using-cell"><a class="header" href="#benefits-of-using-cell">Benefits of Using Cell</a></h3>
<ul>
<li><a href="t=0:11:19s"></a> The benefit of using cell is that you can have multiple shared references to a thing.</li>
<li>Cell is usually used with something like RC where you want the cell to be stored in multiple places or pointers to
it’d be stored in multiple places like in some data structure like imagine a graph where some of the things might
share a value right then you might have multiple references to a thing.</li>
</ul>
<h3 id="usage-of-cell"><a class="header" href="#usage-of-cell">Usage of Cell</a></h3>
<ul>
<li><a href="t=0:12:02s"></a> Cell should usually just be used for small copy types.</li>
<li>You can only get the value out of a cell either if you have a mutable reference to it or if the value is copy.</li>
</ul>
<h2 id="implementing-sell-ourselves"><a class="header" href="#implementing-sell-ourselves"><a href="t=0:13:18s">#</a> Implementing Sell Ourselves</a></h2>
<p>Section Overview: In this section, the speaker demonstrates how to implement sell ourselves.</p>
<h3 id="basic-api"><a class="header" href="#basic-api">Basic API</a></h3>
<ul>
<li>We need a pub struct called “cell” which holds a T.</li>
<li>We will implement:
<ul>
<li>A new function which takes a value of type T and returns self. This gives us a cell that contains the given value.</li>
<li>A set function which takes an immutable reference to self and a value T. It sets self.value equal to value but
currently will not work because we are trying to assign to self.value which is behind a shared reference and so we
can’t modify it.</li>
<li>A get function which returns a T. This is like the basic API we are going for.</li>
</ul>
</li>
</ul>
<h3 id="unsafe-cell"><a class="header" href="#unsafe-cell">Unsafe Cell</a></h3>
<ul>
<li><a href="t=0:15:06s"></a> At the core of almost all of these types to provide interior mutability is a special cell type called
unsafe cell.</li>
<li>We will use cell unsafe cell so that the value here is an unsafe cell. That’s the only way that we can actually mutate
something through a shared reference.</li>
<li>Cell is usually used for smaller values like numbers or flags that need to be mutated from multiple different places.</li>
</ul>
<h2 id="introduction-to-unsafe-cell"><a class="header" href="#introduction-to-unsafe-cell">Introduction to Unsafe Cell</a></h2>
<p>Section Overview: In this section, the speaker introduces the concept of unsafe cell and explains how it can be used to
dereference a raw pointer.</p>
<h3 id="using-unsafe-cell"><a class="header" href="#using-unsafe-cell">Using Unsafe Cell</a></h3>
<ul>
<li>The value of unsafe cell is just unsafe sell new values.</li>
<li>Trying to dereference a raw pointer is currently incorrect because the compiler doesn’t know if anyone else is
mutating that value.</li>
<li>Writing “unsafe” here tells the compiler that we have checked that no one else is currently mutating this value.
However, this code will be rejected if two threads try to write to a value at the same time.</li>
</ul>
<h3 id="implementing-not-sync-for-cell-t"><a class="header" href="#implementing-not-sync-for-cell-t">Implementing Not Sync for Cell T</a></h3>
<ul>
<li>We need to implement not sync for cell T and tell the compiler that you can never share a cell across threads.</li>
<li>Unsafe cell itself is not sync, which means that cell is not sync. Therefore, this unsafe code will be rejected.</li>
</ul>
<h2 id="recap-of-unsafe-cell"><a class="header" href="#recap-of-unsafe-cell">Recap of Unsafe Cell</a></h2>
<p>Section Overview: In this section, the speaker summarizes what was covered in the previous section about unsafe cells.</p>
<h3 id="summary-of-unsafe-cell"><a class="header" href="#summary-of-unsafe-cell">Summary of Unsafe Cell</a></h3>
<ul>
<li>The cell type allows you to modify a value through a shared reference because no other threads have a reference to it.</li>
<li>Get returns a copy of the value stored inside so even if we change the value, we don’t have to invalidate any
references because there are no references outside.</li>
</ul>
<h2 id="cell-and-sync"><a class="header" href="#cell-and-sync"><a href="t=0:24:13s">#</a> Cell and Sync</a></h2>
<p>Section Overview: In this section, the speaker discusses how to use cell and sync in Rust.</p>
<h3 id="using-cell-to-get-a-reference"><a class="header" href="#using-cell-to-get-a-reference">Using Cell to Get a Reference</a></h3>
<ul>
<li>Use <code>Cell</code> to get a reference out.</li>
<li>Get a reference to the first thing inside the vector.</li>
<li>Do not allow this code because once you call set that vector is gone as a first should be invalidated.</li>
</ul>
<p><a href="t=0:24:13s"></a></p>
<h3 id="disallowing-unsafe-implementation-of-sync"><a class="header" href="#disallowing-unsafe-implementation-of-sync">Disallowing Unsafe Implementation of Sync</a></h3>
<ul>
<li>Never give out a reference which means a set is always safe.</li>
<li>Disallow unsafe implementation of sync by getting not returning a reference but only return to copy.</li>
</ul>
<p><a href="t=0:25:06s"></a></p>
<h3 id="demonstrating-broken-code-with-multiple-threads"><a class="header" href="#demonstrating-broken-code-with-multiple-threads">Demonstrating Broken Code with Multiple Threads</a></h3>
<ul>
<li>It’s hard to write tests that fail when there are multiple threads.</li>
<li>Have one thread that tries to set the whole value, and one that sets it differently.</li>
<li>Wait for both threads to finish and then print out the value that ends up being stored in there.</li>
</ul>
<p><a href="t=0:30:00s"></a></p>
<h2 id="the-problem-with-interleaving-threads"><a class="header" href="#the-problem-with-interleaving-threads">The Problem with Interleaving Threads</a></h2>
<p>Section Overview: In this section, the speaker discusses the problem of interleaving threads and how it can lead to
corrupted arrays.</p>
<h3 id="interleaving-threads"><a class="header" href="#interleaving-threads">Interleaving Threads</a></h3>
<ul>
<li>When two threads are modifying the same bit of memory at the same time, there is no guarantee that they won’t step on
each other.</li>
<li>If one thread writes its value and then goes to sleep while another thread runs for a while and then goes to sleep,
we’ll see an interleaving of values.</li>
<li>This can result in a corrupted array that contains some values that were never set by either thread.</li>
<li>The underlying memory system being fast enough can prevent this from happening in practice, but it’s still a potential
issue.</li>
</ul>
<h3 id="demonstrating-the-problem"><a class="header" href="#demonstrating-the-problem">Demonstrating the Problem</a></h3>
<ul>
<li>By running a test where two threads increment a shared value 100,000 times each, we can demonstrate how interleaving
threads can cause lost modifications.</li>
<li>Because both threads are modifying the same value at the same time, some modifications end up being lost.</li>
<li>This results in an incorrect final value for the shared variable.</li>
</ul>
<h2 id="non-copy-types-and-trait-bounds"><a class="header" href="#non-copy-types-and-trait-bounds">Non-Copy Types and Trait Bounds</a></h2>
<p>Section Overview: In this section, the speaker discusses why non-copy types don’t require trait bounds and why putting
trait bounds only where they’re needed is more idiomatic in Rust.</p>
<h3 id="copy-trait-requirement"><a class="header" href="#copy-trait-requirement">Copy Trait Requirement</a></h3>
<ul>
<li>A question is asked about why non-copy types are allowed if only the get method requires copy types.</li>
<li>The speaker explains that generally only putting trait bounds where they’re needed is more idiomatic in Rust.</li>
<li>Putting trait bounds on every type that contains a cell would result in extraneous bounds all over the place.</li>
</ul>
<h3 id="constrained-trait-bounds"><a class="header" href="#constrained-trait-bounds">Constrained Trait Bounds</a></h3>
<ul>
<li>By putting trait bounds only where they’re needed (i.e. on methods like get), callers only have to worry about those
constraints when they’re actually using those methods.</li>
<li>This is usually the most constrained space and makes for cleaner code.</li>
</ul>
<h2 id="unsafe-cell-and-ref-cell"><a class="header" href="#unsafe-cell-and-ref-cell">Unsafe Cell and Ref Cell</a></h2>
<p>Section Overview: In this section, the speaker explains what Unsafe Cell and Ref Cell are in Rust programming language.</p>
<h3 id="unsafe-cell-1"><a class="header" href="#unsafe-cell-1">Unsafe Cell</a></h3>
<ul>
<li>Unsafe cell is a special type in Rust that allows you to mutate data even if it’s shared.</li>
<li>You cannot cast a shared reference into an exclusive reference without going through unsafe cell because the Rust
compiler optimizes your code and how it interacts with LLVM.</li>
</ul>
<h3 id="ref-cell"><a class="header" href="#ref-cell">Ref Cell</a></h3>
<ul>
<li>Ref cell is a type of immutable memory location with dynamically checked borrow rules.</li>
<li>It lets you check at runtime whether anyone else is mutating this value, which is useful for traversing graphs or
trees where there might be cycles.</li>
<li>The ref cell has a method called borrow which takes a shared reference to self and gives you an option reference to T.
It also has a borrow mute method that initially makes both methods return None.</li>
</ul>
<h2 id="refcell-and-cell"><a class="header" href="#refcell-and-cell"><a href="t=0:46:55s">#</a> RefCell and Cell</a></h2>
<p>Section Overview: In this section, the speaker explains how to use RefCell and Cell in Rust.</p>
<h3 id="borrowing-with-refcell-and-cell"><a class="header" href="#borrowing-with-refcell-and-cell">Borrowing with RefCell and Cell</a></h3>
<ul>
<li><a href="t=0:47:24s"></a> The borrow and borrow_mut methods are not suitable for this case.</li>
<li><a href="t=0:48:02s"></a> If the state is unshared, we can give out a value. Otherwise, we cannot.</li>
<li><a href="t=0:48:49s"></a> If it’s exclusively borrowed out, it’s not okay to give out a shared reference.</li>
<li><a href="t=0:49:28s"></a> We need to set self.state to be exclusive if we give out an exclusive reference.</li>
</ul>
<h3 id="using-cell-instead-of-refcell"><a class="header" href="#using-cell-instead-of-refcell">Using Cell instead of RefCell</a></h3>
<ul>
<li><a href="t=0:50:14s"></a> Modifying ref state here is not thread-safe.</li>
<li><a href="t=0:51:29s"></a> We can make this a cell because it gives us exactly what we need.</li>
<li><a href="t=0:52:18s"></a> Mutex is basically a thread-safe version of RefCell.</li>
</ul>
<h3 id="safety-argument"><a class="header" href="#safety-argument">Safety Argument</a></h3>
<ul>
<li><a href="t=0:53:05s"></a> No exclusive references have been given out since state would be exclusive or shared when using
something like Rayon.</li>
</ul>
<h2 id="ref-type"><a class="header" href="#ref-type">Ref Type</a></h2>
<p>Section Overview: In this section, the speaker discusses the implementation of a ref type and a ref mute type to solve
the problem of shared and exclusive references.</p>
<h3 id="implementation-of-ref-type"><a class="header" href="#implementation-of-ref-type">Implementation of Ref Type</a></h3>
<ul>
<li>A ref type is created with a lifetime that points to the ref cell.</li>
<li>The ref cell contains a reference to the inner value.</li>
<li>When a ref is dropped, the reference count is decremented.</li>
<li>If there are no shared references left, then it becomes unshared.</li>
</ul>
<h3 id="deref-trait"><a class="header" href="#deref-trait">Deref Trait</a></h3>
<ul>
<li>The Deref trait allows for automatic dereferencing into an inner type.</li>
<li>Given a reference to self, it returns a reference to the target type T.</li>
<li>This allows calling any method that requires a reference of T on it.</li>
</ul>
<h3 id="safety-argument-1"><a class="header" href="#safety-argument-1">Safety Argument</a></h3>
<ul>
<li>The safety argument is updated to say that the ref is only created if no exclusive references have been given out.</li>
<li>Dereferencing into a shared reference is fine since no exclusive references are given out.</li>
</ul>
<h2 id="refcell-and-rc"><a class="header" href="#refcell-and-rc">RefCell and Rc</a></h2>
<p>Section Overview: In this section, the speaker explains RefCell and Rc in Rust programming language.</p>
<h3 id="refcell"><a class="header" href="#refcell">RefCell</a></h3>
<ul>
<li>RefCell allows for mutable data to be shared between multiple owners.</li>
<li>RefMut is only created if no other references have been given out once it is given out state is set to exclusive so no
future references are given out so we have an exclusive lease on the inner value so dereferencing is fine mutable or
immutable EDD referencing is fine.</li>
<li>Safety here is see safety 4d refute.</li>
<li>It’s common practice to write safety comments for every unsafe use.</li>
</ul>
<h3 id="rc"><a class="header" href="#rc">RC</a></h3>
<ul>
<li>RC provides shared ownership of a value of type T allocated in the heap.</li>
<li>Shared references in rust disallow mutation by default and RC is no exception.</li>
<li>RC never provides mutability all it does is allow you to have multiple shared references to a thing and only
deallocate it when the last one goes away.</li>
<li>RC is not thread safe, but even on a single thread, this can be useful often again in the context of data structures
or things like graphs.</li>
</ul>
<h2 id="rc-and-smart-pointers"><a class="header" href="#rc-and-smart-pointers">RC and Smart Pointers</a></h2>
<p>Section Overview: In this section, the speaker explains the difference between weak and strong pointers. They then
introduce RC (Reference Counted) smart pointers and explain how they work.</p>
<h3 id="weak-vs-strong-pointers"><a class="header" href="#weak-vs-strong-pointers">Weak vs Strong Pointers</a></h3>
<ul>
<li>A weak pointer will not prevent an object from being deleted, whereas a strong pointer will.</li>
<li>Weak smart pointers need to be upgraded to a real pointer before use, but this upgrade can fail.</li>
</ul>
<h3 id="introduction-to-rc-smart-pointers"><a class="header" href="#introduction-to-rc-smart-pointers">Introduction to RC Smart Pointers</a></h3>
<ul>
<li>An RC is a pointer to some type T that is stored on the heap.</li>
<li>The value needs to be stored on the heap because if multiple functions in the code reference it, it cannot be on the
stack of any given function.</li>
<li>The reference count has to be in the value that is shared amongst all copies of the RC.</li>
<li>An RC inner holds both the value and reference count.</li>
</ul>
<h3 id="implementing-clone-for-t"><a class="header" href="#implementing-clone-for-t">Implementing Clone for T</a></h3>
<ul>
<li>Cloning an RC increases its reference count without copying its inner value.</li>
<li>DRF (Dereference), implemented for RCT, works similarly for RC by returning a raw pointer to T.</li>
<li>This implementation requires unsafe blocks because Rust’s compiler does not know whether a pointer is still valid.</li>
</ul>
<h2 id="rust-reference-types"><a class="header" href="#rust-reference-types">Rust Reference Types</a></h2>
<p>Section Overview: In this section, the speaker discusses reference types in Rust and the semantics that must be followed
when using them.</p>
<h3 id="reference-types"><a class="header" href="#reference-types">Reference Types</a></h3>
<ul>
<li>Ref Mew T, Star Mew T, Star Consti So Star Mute and Star Const are not references but raw pointers.</li>
<li>Ampersand symbol means a shared reference. Ampersand mute means an exclusive reference.</li>
<li>The star versions of these like star constants star mute do not have guarantees. If you have a raw pointer, the only
thing you can really do to it is use an unsafe block to dereference it and turn it into a reference.</li>
<li>The difference between star constant and star mute is fuzzy. A star mute is usually something that you might be able
to mutate something you might have an exclusive exclusive reference to whereas the star constant is intended to
signify that you will never mutate this.</li>
</ul>
<h2 id="box-in-rust"><a class="header" href="#box-in-rust">Box in Rust</a></h2>
<p>Section Overview: In this section, the speaker discusses what box provides for us in Rust.</p>
<h3 id="box-provides-heap-allocation"><a class="header" href="#box-provides-heap-allocation">Box Provides Heap Allocation</a></h3>
<ul>
<li>Box provides heap allocation which lets us go from our Zener which would otherwise be on the stack to a pointer that
is on the heap which is what we store here.</li>
<li>For clone here we’re going to increase the reference count but here we have the same problem as we did for ref cell
right which is we have a shared reference to self but we need to mutate something inside of it and so here lo and
behold the problem is the answer is the same thing that we’ve done before it’s our friend cell.</li>
</ul>
<h2 id="unsafe-keyword-in-rust"><a class="header" href="#unsafe-keyword-in-rust">Unsafe Keyword in Rust</a></h2>
<p>Section Overview: In this section, the speaker discusses the unsafe keyword in Rust and its meaning.</p>
<h3 id="unsafe-keyword"><a class="header" href="#unsafe-keyword">Unsafe Keyword</a></h3>
<ul>
<li>The unsafe keyword is a little weird because really what it means is I have checked that the stuff inside the brackets
is safe. It’s like I as the programmer certified that this is safe so it’s not really unsafe.</li>
<li>It’s like in some sense saying that I acknowledge that this code seems unsafe but it’s actually safe so I agree with
you it’s a little bit of a weird keyword name.</li>
</ul>
<h2 id="smart-pointers-in-rust"><a class="header" href="#smart-pointers-in-rust">Smart Pointers in Rust</a></h2>
<p>Section Overview: In this section, the speaker discusses smart pointers in Rust and how to deallocate them.</p>
<h3 id="deallocating-smart-pointers"><a class="header" href="#deallocating-smart-pointers">Deallocating Smart Pointers</a></h3>
<ul>
<li>When an RC goes away we need to make sure that when the last RC goes away then we actually deallocate otherwise there
will be a memory leak.</li>
<li>We are going to check with the countess if the count is one we are being dropped for after us there will be no RCS and
no references to tea otherwise there are other references there are other RCS so don’t drop the box.</li>
</ul>
<h2 id="understanding-variance-in-rust"><a class="header" href="#understanding-variance-in-rust">Understanding Variance in Rust</a></h2>
<p>Section Overview: In this section, the speaker explains variance in Rust and how it relates to star-mutant-star-const.
They also introduce non-null as a way to optimize code.</p>
<h3 id="variance-in-rust"><a class="header" href="#variance-in-rust">Variance in Rust</a></h3>
<ul>
<li>Variance is one of the primary differences between star mutant star const.</li>
<li>Non-null is used for optimization purposes because it allows the compiler to know that a pointer cannot be null.</li>
<li>Option non-null can use the null pointer to represent none without any overhead.</li>
</ul>
<h3 id="using-non-null"><a class="header" href="#using-non-null">Using Non-Null</a></h3>
<ul>
<li>The standard library has a neat thing called non-null that we can use instead of using star mute.</li>
<li>We give it a storm utage from box from raw and use it to get back this star mutti which is what we need for into raw.</li>
</ul>
<h2 id="using-unsafe-pointers-in-rust"><a class="header" href="#using-unsafe-pointers-in-rust">Using Unsafe Pointers in Rust</a></h2>
<p>Section Overview: In this section, the speaker explains how to use unsafe pointers in Rust and why they are necessary.</p>
<h3 id="using-unsafe-rf-method-on-non-null"><a class="header" href="#using-unsafe-rf-method-on-non-null">Using Unsafe RF Method on Non Null</a></h3>
<ul>
<li>We can use the unsafe RF method on non-null instead of having this star ampersand star thing.</li>
<li>This is obviously unsafe, but we know that we’re keeping the reference count correctly.</li>
</ul>
<h3 id="why-unsafe-pointers-are-necessary"><a class="header" href="#why-unsafe-pointers-are-necessary">Why Unsafe Pointers are Necessary</a></h3>
<ul>
<li>The compiler doesn’t know that we have the last pointer and therefore that it’s safe to turn this back into a box and
drop it.</li>
<li>We know because we know that we’re keeping the reference count correctly.</li>
</ul>
<h2 id="lifetime-guarantees-in-rust"><a class="header" href="#lifetime-guarantees-in-rust">Lifetime Guarantees in Rust</a></h2>
<p>Section Overview: In this section, the speaker explains lifetime guarantees in Rust and why you cannot store mutable
references outside their scope.</p>
<h3 id="why-you-cannot-store-mutable-references-outside-their-scope"><a class="header" href="#why-you-cannot-store-mutable-references-outside-their-scope">Why You Cannot Store Mutable References Outside Their Scope</a></h3>
<ul>
<li>If you tried to stick the mutable reference you got back from mute somewhere and then dropped the ref mute and then
tried to use this mutable reference again, the compiler would say no that’s not allowed.</li>
<li>You’re trying to use this mutable reference after the lifetime it’s tied to has already expired because the refuge has
gone away.</li>
</ul>
<h3 id="difference-between-mutable-pointer-and-mutable-reference"><a class="header" href="#difference-between-mutable-pointer-and-mutable-reference">Difference Between Mutable Pointer and Mutable Reference</a></h3>
<ul>
<li>A mutable pointer is just a pointer with certain semantics and we call it star mute.</li>
<li>It does not carry the additional implication that it’s exclusive which is what allows you to mutate through things.</li>
</ul>
<h2 id="understanding-memory-in-rust"><a class="header" href="#understanding-memory-in-rust">Understanding Memory in Rust</a></h2>
<p>Section Overview: In this section, the speaker explains how memory works in Rust and why a cell is necessary even if
there is a mutable pointer.</p>
<h3 id="why-a-cell-is-necessary-even-if-there-is-a-mutable-pointer"><a class="header" href="#why-a-cell-is-necessary-even-if-there-is-a-mutable-pointer">Why a Cell is Necessary Even if There is a Mutable Pointer</a></h3>
<ul>
<li>We have a mutable pointer but it’s not safe for us to mutate through it.</li>
<li>This is the difference between a mutable pointer and a mutable reference.</li>
</ul>
<h1 id="inner-dog-ref-count"><a class="header" href="#inner-dog-ref-count">Inner Dog Ref Count</a></h1>
<p>Section Overview: In this section, the speaker explains why it’s important to add a marker in Rust when a type owns
another type. They also discuss how accessing something through a pointer that has just been deallocated can cause
issues.</p>
<h2 id="importance-of-marker-in-rust"><a class="header" href="#importance-of-marker-in-rust">Importance of Marker in Rust</a></h2>
<ul>
<li>It’s important to add a marker in Rust when a type owns another type.</li>
<li>If someone later comes along and writes code that accesses something through the pointer that was just deallocated,
the compiler won’t warn them that this isn’t okay.</li>
<li>This is because they won’t know that this is the case if there isn’t a marker present.</li>
</ul>
<h2 id="drop-check-in-rust"><a class="header" href="#drop-check-in-rust">Drop Check in Rust</a></h2>
<ul>
<li>The speaker introduces drop check in Rust and explains why it’s important to implement RC properly.</li>
<li>Drop check is used by Rust to ensure that types are dropped in the correct order.</li>
<li>If types are not dropped in the correct order, it can lead to errors and crashes.</li>
</ul>
<h2 id="example-of-drop-check-issue"><a class="header" href="#example-of-drop-check-issue">Example of Drop Check Issue</a></h2>
<ul>
<li>The speaker provides an example of how drop check can cause issues if not implemented properly.</li>
<li>They explain how dropping foo calls a method on the string through its drop implementation, but since drop is
implicit, it can lead to problems if types are not dropped in the correct order.</li>
</ul>
<h1 id="understanding-drop-check"><a class="header" href="#understanding-drop-check">Understanding Drop Check</a></h1>
<p>Section Overview: In this section, the speaker goes into more detail about drop check and how it works. They provide
examples of how incorrect use of drop check can lead to errors and crashes.</p>
<h2 id="how-drop-check-works"><a class="header" href="#how-drop-check-works">How Drop Check Works</a></h2>
<ul>
<li>When functions or any type gets dropped, Rust assumes that every use of that type is a test of use for all fields
contained within it.</li>
<li>This means that even if drop is not explicitly written, Rust will treat it as if it’s accessing every field of the
type.</li>
<li>If types are dropped in the wrong order, Rust will catch this as a problem and throw an error.</li>
</ul>
<h2 id="example-of-drop-check-issue-1"><a class="header" href="#example-of-drop-check-issue-1">Example of Drop Check Issue</a></h2>
<ul>
<li>The speaker provides another example of how incorrect use of drop check can lead to errors.</li>
<li>They explain how dropping foo before T can cause issues because foo holds a reference to T.</li>
</ul>
<h1 id="understanding-phantom-data-in-rust"><a class="header" href="#understanding-phantom-data-in-rust">Understanding Phantom Data in Rust</a></h1>
<p>Section Overview: This section explains the concept of phantom data in Rust and how it is used to ensure that the
dropping of an RC is checked at compile time.</p>
<h2 id="phantom-data"><a class="header" href="#phantom-data">Phantom Data</a></h2>
<ul>
<li>Phantom data tells Rust to treat a type as though there is one even though there is only a pointer to it.</li>
<li>It ensures that when we drop an RC, we treat it as dropping one of these types.</li>
<li>The marker is needed when T is not static, but we want to allow any T here.</li>
<li>The wrapper internally in the standard library was added to guard against someone accidentally writing an
implementation for RC in ER.</li>
</ul>
<h2 id="question-mark-sized-types"><a class="header" href="#question-mark-sized-types">Question Mark Sized Types</a></h2>
<ul>
<li>Question mark sized types are used to opt-out of the requirement that every generic argument must be sized.</li>
<li>Coerce incised trait deals with some of the restrictions of why it’s hard for you to implement RC Foley yourself if
you want to support dynamically sized types.</li>
</ul>
<h2 id="benefits-of-using-rust-over-c"><a class="header" href="#benefits-of-using-rust-over-c">Benefits of Using Rust Over C</a></h2>
<ul>
<li>Writing convoluted code like this rarely happens in your own code.</li>
<li>In Rust, these problems are caught at compile time rather than run time.</li>
</ul>
<h1 id="refcell-mutex-and-arc"><a class="header" href="#refcell-mutex-and-arc">RefCell, Mutex and Arc</a></h1>
<p>Section Overview: This section covers the difference between exclamation marks sized and question mark sized. It also
explains how synchronous versions of RefCell, Mutex and Arc work.</p>
<h2 id="exclamation-marks-sized-vs-question-mark-sized"><a class="header" href="#exclamation-marks-sized-vs-question-mark-sized">Exclamation Marks Sized vs Question Mark Sized</a></h2>
<ul>
<li>Exclamation mark sized means not sized.</li>
<li>Question mark size means it does not have to be sized.</li>
<li>Default is that everything has a size bound.</li>
<li>Opt out of that bound by using exclamation marks or question marks.</li>
</ul>
<h2 id="synchronous-versions-of-refcell-mutex-and-arc"><a class="header" href="#synchronous-versions-of-refcell-mutex-and-arc">Synchronous Versions of RefCell, Mutex and Arc</a></h2>
<ul>
<li>Strategies written so far don’t quite work right in the cell case if you have multiple threads to can mutate at the
same time there just is no equivalent of cell because even though you’re not giving out references to things having
two threads modify the same type at the same value at the same time it’s just not okay so actually is no thread-safe
version of cell refs l is a little interesting so in the ref cell we wrote right you have borrow and borrow mute and
they return options you could totally implement a thread-safe version of ref cell one that uses an atomic counter
instead of cell for these numbers.</li>
<li>Thread-safe version of ref cell uses an atomic counter instead of a cell for these numbers. CPU has built-in
instructions that can increment and decrement counters in a thread safe way.</li>
<li>Multi-threaded or synchronized version of RefCell is usually our W lock.</li>
<li>Reader/writer lock (R/W lock), which is one type in sync, is basically a ref cell where counters are kept using
Atomics so they are thread-safe but also borrow and borrow mute which in the reader/writer lock are called read and
write they don’t return an option instead they always return the ref for the ref mute but what they do is they block
the current thread if the borrow can’t succeed yet so they block the current thread until the conditions are met.</li>
<li>Mutex is a simplified version of RefCell where there’s only borrow mute as you don’t need to keep all these extra
counts for how many readers or how many shared references there are it’s just either it some other thread has a
reference to it or some of the threads is not and it similarly has blocking behavior where when you call lock on a
mutex it will block until there are no other references to the inner value and at that point you’re given that
reference and it similarly has a guard the same way ref cell does.</li>
<li>Arc (Atomic Reference Count) is pretty much exactly the same as our C except that it uses these thread safe operations
these atomic CPU Atomics for managing the reference count rather than a cell. It cannot be sent because if I sent an
RC to some other thread and that other thread dropped the RC and I dropped an RC at the same time both of us would try
to use cell to decrement count but that’s obviously not okay because cell is not thread safe. Non-null is also not
send by default.</li>
</ul>
<h1 id="rc-vs-art"><a class="header" href="#rc-vs-art">RC vs Art</a></h1>
<p>Section Overview: This section discusses why one might prefer RC over Art.</p>
<h2 id="cost-of-using-atomics"><a class="header" href="#cost-of-using-atomics">Cost of Using Atomics</a></h2>
<ul>
<li>RC is cheaper than Art.</li>
<li>Atomics are more expensive in terms of CPU cycles and coordination overhead between cores.</li>
<li>Non-thread safe versions are preferred because they have lower overhead.</li>
</ul>
<h2 id="asynchronous-mutexes"><a class="header" href="#asynchronous-mutexes">Asynchronous Mutexes</a></h2>
<ul>
<li>Async Std, Tokyo, Futures crate, and Futures Intrusive crate all have asynchronous mutexes.</li>
</ul>
<h1 id="the-cow-type"><a class="header" href="#the-cow-type">The Cow Type</a></h1>
<p>Section Overview: This section covers the Cow type and its implementation.</p>
<h2 id="copy-on-write"><a class="header" href="#copy-on-write">Copy-On-Write</a></h2>
<ul>
<li>The Cow type is an enum that is either owned or borrowed.</li>
<li>If a Cow of T contains a reference to a T, it passes access through. If it owns the thing it contains, it gives you a
reference to that.</li>
<li>If you want to modify the value inside of a copy-on-write when it’s just holding a reference, you can’t modify it
because it’s shared.</li>
</ul>
<h2 id="benefits-of-cow-type"><a class="header" href="#benefits-of-cow-type">Benefits of Cow Type</a></h2>
<ul>
<li>Cow allows for modification only when necessary by cloning the value and turning it into the owned version.</li>
<li>It’s useful when most of the time you don’t need a copy because you’re only going to read but sometimes you need to
modify it.</li>
</ul>
<h1 id="example-escape-function-with-cow-type"><a class="header" href="#example-escape-function-with-cow-type">Example: Escape Function with Cow Type</a></h1>
<p>Section Overview: This section provides an example use case for the Cow type in an escape function.</p>
<h2 id="escaping-function-with-string-input"><a class="header" href="#escaping-function-with-string-input">Escaping Function with String Input</a></h2>
<ul>
<li>An escape function takes a string and returns the string.</li>
<li>Cow is useful in this case because if you don’t have to modify it, you just pass it through. Only if you do have to
change something do you clone and mutate it.</li>
</ul>
<h1 id="from-utf-8-lossy"><a class="header" href="#from-utf-8-lossy">From Utf-8 Lossy</a></h1>
<p>Section Overview: This section discusses why from_utf8_lossy returns Cow but other UTF variants don’t.</p>
<h2 id="from-utf-8-lossy-1"><a class="header" href="#from-utf-8-lossy-1">From Utf-8 Lossy</a></h2>
<ul>
<li>The reason from_utf8_lossy returns Cow is that if the given byte string is completely valid utf-8, it can just pass it
straight through.</li>
</ul>
<h1 id="cow-type-and-smart-pointers"><a class="header" href="#cow-type-and-smart-pointers">Cow Type and Smart Pointers</a></h1>
<p>Section Overview: This section covers the cow type and smart pointers in Rust.</p>
<h2 id="cow-type"><a class="header" href="#cow-type">Cow Type</a></h2>
<ul>
<li>The cow type allows you to avoid allocation if you don’t need to modify.</li>
<li>Other from UTA types usually allocate regardless, but with the cow type, there is no reason to do so.</li>
</ul>
<h2 id="smart-pointers"><a class="header" href="#smart-pointers">Smart Pointers</a></h2>
<ul>
<li>Rust has several smart pointer types.</li>
<li>Cell is for non-thread safe non-reference interior mutability.</li>
<li>Ref cell is for dynamic interior mutability.</li>
<li>RC is for dynamically shared references where you don’t know how many references are going to be or when the inner
value will be dropped at runtime.</li>
<li>There are also thread-safe versions of these types called synchronized versions.</li>
<li>Cow is not really a smart pointer but kind of a copy-on-write pointer that upgrades when needed.</li>
</ul>
<h1 id="recap-and-next-steps"><a class="header" href="#recap-and-next-steps">Recap and Next Steps</a></h1>
<p>Section Overview: This section provides a recap of what was covered in the previous section and discusses what will be
covered next.</p>
<h2 id="recap"><a class="header" href="#recap">Recap</a></h2>
<ul>
<li>The previous section covered the cow type and smart pointers in Rust.</li>
</ul>
<h2 id="next-steps"><a class="header" href="#next-steps">Next Steps</a></h2>
<ul>
<li>The next stream may cover trade objects, borrow trait, or trade delegation.</li>
</ul>
<h2 id="generated-by-video-highlight"><a class="header" href="#generated-by-video-highlight">Generated by Video Highlight</a></h2>
<p>https://videohighlight.com/video/summary/8O0Nt9qY_vo</p>

            </main>

            <!--            <script src="https://utteranc.es/client.js"-->
            <!--                    repo="RustMagazine/rust_magazine_2022"-->
            <!--                    issue-term="title"-->
            <!--                    theme="github-light"-->
            <!--                    crossorigin="anonymous"-->
            <!--                    async></script>-->

            <nav class="nav-wrapper" aria-label="Page navigation">
                <!-- Mobile navigation buttons -->
                    <a rel="prev" href="../../rust_video_summary/curst_of_rust/lifetime_annotations.html" class="mobile-nav-chapters previous"
                       title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../../rust_video_summary/curst_of_rust/sorting_algorithms.html" class="mobile-nav-chapters next"
                       title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>

                <div style="clear: both"></div>
            </nav>
        </div>
    </div>

    <nav class="nav-wide-wrapper" aria-label="Page navigation">
            <a rel="prev" href="../../rust_video_summary/curst_of_rust/lifetime_annotations.html" class="nav-chapters previous" title="Previous chapter"
               aria-label="Previous chapter" aria-keyshortcuts="Left">
                <i class="fa fa-angle-left"></i>
            </a>

            <a rel="next" href="../../rust_video_summary/curst_of_rust/sorting_algorithms.html" class="nav-chapters next" title="Next chapter"
               aria-label="Next chapter" aria-keyshortcuts="Right">
                <i class="fa fa-angle-right"></i>
            </a>
    </nav>

</div>



    <script type="text/javascript">
        window.playground_line_numbers = true;
    </script>

    <script type="text/javascript">
        window.playground_copyable = true;
    </script>

    <script src="../../ace.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../editor.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../mode-rust.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../theme-dawn.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../theme-tomorrow_night.js" type="text/javascript" charset="utf-8"></script>

    <script src="../../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../mark.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../searcher.js" type="text/javascript" charset="utf-8"></script>

<script src="../../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
<script src="../../highlight.js" type="text/javascript" charset="utf-8"></script>
<script src="../../book.js" type="text/javascript" charset="utf-8"></script>

<!-- Custom JS scripts -->
    <script type="text/javascript" src="../../assets/ferris/ferris.js"></script>
    <script type="text/javascript" src="../../assets/mermaid/mermaid.min.js"></script>
    <script type="text/javascript" src="../../assets/mermaid/mermaid-init.js"></script>
    <script type="text/javascript" src="../../assets/smart-anchor.js"></script>
    <script type="text/javascript" src="../../assets/pagetoc/sidebar.js"></script>

</body>
</html>
